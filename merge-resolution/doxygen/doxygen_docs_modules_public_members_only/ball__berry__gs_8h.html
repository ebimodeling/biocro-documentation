<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The BioCro C++ Library: /github/workspace/src/module_library/ball_berry_gs.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">The BioCro C++ Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('ball__berry__gs_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">ball_berry_gs.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="stomata__outputs_8h_source.html">stomata_outputs.h</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for ball_berry_gs.h:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="ball__berry__gs_8h__incl.png" border="0" usemap="#a_2github_2workspace_2src_2module__library_2ball__berry__gs_8h" alt=""/></div>
<map name="a_2github_2workspace_2src_2module__library_2ball__berry__gs_8h" id="a_2github_2workspace_2src_2module__library_2ball__berry__gs_8h">
<area shape="rect" title=" " alt="" coords="5,5,156,61"/>
<area shape="rect" href="stomata__outputs_8h.html" title=" " alt="" coords="16,109,145,136"/>
</map>
</div>
</div><div class="textblock"><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="ball__berry__gs_8h__dep__incl.png" border="0" usemap="#a_2github_2workspace_2src_2module__library_2ball__berry__gs_8hdep" alt=""/></div>
<map name="a_2github_2workspace_2src_2module__library_2ball__berry__gs_8hdep" id="a_2github_2workspace_2src_2module__library_2ball__berry__gs_8hdep">
<area shape="rect" title=" " alt="" coords="373,5,523,61"/>
<area shape="rect" href="ball__berry_8h.html" title=" " alt="" coords="7,109,158,165"/>
<area shape="rect" href="ball__berry__gs_8cpp.html" title=" " alt="" coords="182,109,333,165"/>
<area shape="rect" href="c3photo_8cpp.html" title=" " alt="" coords="357,117,539,158"/>
<area shape="rect" href="c4photo_8cpp.html" title=" " alt="" coords="563,117,746,158"/>
<area shape="rect" href="rue__leaf__photosynthesis_8cpp.html" title=" " alt="" coords="770,109,929,165"/>
<area shape="rect" href="module__library_8cpp.html" title=" " alt="" coords="5,213,160,269"/>
</map>
</div>
</div>
<p><a href="ball__berry__gs_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad24d3b65b48b6defb685a6bd3094d0f1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structstomata__outputs.html">stomata_outputs</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ball__berry__gs_8h.html#ad24d3b65b48b6defb685a6bd3094d0f1">ball_berry_gs</a> (double assimilation, double ambient_c, double ambient_rh, double bb_offset, double bb_slope, double gbw, double leaf_temperature, double ambient_air_temperature)</td></tr>
<tr class="memdesc:ad24d3b65b48b6defb685a6bd3094d0f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates steady-state stomatal conductance to water vapor using the Ball-Berry model.  <a href="ball__berry__gs_8h.html#ad24d3b65b48b6defb685a6bd3094d0f1">More...</a><br /></td></tr>
<tr class="separator:ad24d3b65b48b6defb685a6bd3094d0f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ad24d3b65b48b6defb685a6bd3094d0f1" name="ad24d3b65b48b6defb685a6bd3094d0f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad24d3b65b48b6defb685a6bd3094d0f1">&#9670;&nbsp;</a></span>ball_berry_gs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structstomata__outputs.html">stomata_outputs</a> ball_berry_gs </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>assimilation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ambient_c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ambient_rh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>bb_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>bb_slope</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gbw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>leaf_temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ambient_air_temperature</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates steady-state stomatal conductance to water vapor using the Ball-Berry model. </p>
<p >The Ball-Berry is a simple empirical model for the steady-state response of stomata to external conditions and was first described in Ball and Berry (1987). The main idea is that stomata open in response to brighter light or low CO2 availability, and close in response to low humidity (to limit water losses from transpiration). This idea can be expressed mathematically as</p>
<p class="formulaDsp">
\[
  g_{sw} = b_0 + b_1 \cdot \frac{ A_n \cdot h_s}{C_s} \quad
    \text{if} \; A_n \geq 0, \qquad \text{(1)}
\]
</p>
<p >where \( g_{sw} \) is the stomatal conductance to water vapor diffusion, \( A_n \) is the net CO2 assimilation rate, \( b_0 \) and \( b_1 \) are the Ball-Berry intercept and slope, \( h_s \) is the relative humidity at the leaf surface, and \( C_s \) is the CO2 concentration at the leaf surface. When \( A_n &lt; 0 \), \( g_{sw} = b_0 \).</p>
<p >When using this model in the context of a crop growth simulation, it is necessary to determine \( h_s \) and \( C_s \) from the CO2 concentration and relative humidity in the ambient air surrounding the crop. This can be accomplished using the following equations:</p>
<p class="formulaDsp">
\[
  C_s = C_a - \frac{A_n \cdot 1.37}{g_{bw}} \qquad \text{(2)}
\]
</p>
<p >and</p>
<p class="formulaDsp">
\[
  h_s = \frac{-b + \sqrt{b^2 - 4 \cdot a \cdot c}}{2 \cdot a},
    \qquad \text{(3)}
\]
</p>
<p >where</p>
<p class="formulaDsp">
\[ a = b_1 \cdot \frac{A_n}{C_s}, \]
</p>
<p class="formulaDsp">
\[ b = b_0 + g_{bw} - b_1 \cdot \frac{A_n}{C_s}, \]
</p>
<p >and</p>
<p class="formulaDsp">
\[
  c = - \left( g_{bw} \cdot h_a \cdot \frac{P_{w,sat}(T_a)}{P_{w,sat}(T_l)} +
    b_0 \right)
\]
</p>
<p>.</p>
<p >See the "Using the Ball-Berry Model in Crop Growth Simulations" vignette for more information about this model and these equations.</p>
<p >References:</p><ul>
<li>[Ball, Woodrow, and Berry. "A Model Predicting Stomatal Conductance and its Contribution
  to the Control of Photosynthesis under Different Environmental Conditions" (1987)] (<a href="https://doi.org/10.1007/978-94-017-0519-6_48">https://doi.org/10.1007/978-94-017-0519-6_48</a>)</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">assimilation</td><td>Net CO2 assimilation rate \( A_n \) in units of mol / m^2 / s.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ambient_c</td><td>Ambient CO2 concentration \( C_a \) in units of mol / mol.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ambient_rh</td><td>Ambient relative humidity \( h_a \) expressed as a fraction between 0 and 1 (dimensionless from Pa / Pa).</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bb_offset</td><td>Ball-Berry offset \( b_0 \) in units of mol / m^2 / s.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bb_slope</td><td>Ball-Berry slope \( b_1 \) (dimensionless from [mol / m^2 / s] / [mol / m^2 / s]).</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gbw</td><td>Boundary layer conductance to water vapor diffusion \( g_{bw} \) in units of mol / m^2 / s. For an isolated leaf, this should be the leaf boundary layer conductance; for a leaf within a canopy, this should be the total conductance including the leaf and canopy boundary layer conductances.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">leaf_temperature</td><td>\( T_l \) in units of degrees C.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ambient_air_temperature</td><td>\( T_a \) in units of degrees C.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Stomatal conductance to water vapor diffusion \( g_{sw} \) in units of mmol / m^2 / s </dd></dl>

<p class="definition">Definition at line <a class="el" href="ball__berry__gs_8cpp_source.html#l00097">97</a> of file <a class="el" href="ball__berry__gs_8cpp_source.html">ball_berry_gs.cpp</a>.</p>

<p class="reference">References <a class="el" href="stomata__outputs_8h_source.html#l00009">stomata_outputs::cs</a>, and <a class="el" href="water__and__air__properties_8h_source.html#l00030">saturation_vapor_pressure()</a>.</p>

<p class="reference">Referenced by <a class="el" href="c3photo_8cpp_source.html#l00017">c3photoC()</a>, <a class="el" href="c4photo_8cpp_source.html#l00011">c4photoC()</a>, and <a class="el" href="rue__leaf__photosynthesis_8cpp_source.html#l00022">rue_photo()</a>.</p>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="ball__berry__gs_8h_ad24d3b65b48b6defb685a6bd3094d0f1_cgraph.png" border="0" usemap="#aball__berry__gs_8h_ad24d3b65b48b6defb685a6bd3094d0f1_cgraph" alt=""/></div>
<map name="aball__berry__gs_8h_ad24d3b65b48b6defb685a6bd3094d0f1_cgraph" id="aball__berry__gs_8h_ad24d3b65b48b6defb685a6bd3094d0f1_cgraph">
<area shape="rect" title="Calculates steady&#45;state stomatal conductance to water vapor using the Ball&#45;Berry model." alt="" coords="5,5,104,32"/>
<area shape="rect" href="water__and__air__properties_8h.html#a117fba2c85ba6d52345e7cefc05a43ff" title="Determine saturation water vapor pressure (Pa) from air temperature (degrees C) using the Arden Buck ..." alt="" coords="152,5,327,32"/>
</map>
</div>
<div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="ball__berry__gs_8h_ad24d3b65b48b6defb685a6bd3094d0f1_icgraph.png" border="0" usemap="#aball__berry__gs_8h_ad24d3b65b48b6defb685a6bd3094d0f1_icgraph" alt=""/></div>
<map name="aball__berry__gs_8h_ad24d3b65b48b6defb685a6bd3094d0f1_icgraph" id="aball__berry__gs_8h_ad24d3b65b48b6defb685a6bd3094d0f1_icgraph">
<area shape="rect" title="Calculates steady&#45;state stomatal conductance to water vapor using the Ball&#45;Berry model." alt="" coords="257,56,356,83"/>
<area shape="rect" href="c3photo_8cpp.html#aeeeb3f80125433932e0c8a7468e71df2" title=" " alt="" coords="131,5,209,32"/>
<area shape="rect" href="c4photo_8cpp.html#a0ac8af0343c49f4ab5cf95fe21333179" title=" " alt="" coords="131,56,209,83"/>
<area shape="rect" href="rue__leaf__photosynthesis_8cpp.html#a79b346475d16f0842796a4953de13384" title=" " alt="" coords="131,107,209,133"/>
<area shape="rect" href="c3_can_a_c_8cpp.html#a5ae95949fd0f55e5d42bc4c4f0f6e052" title=" " alt="" coords="5,5,83,32"/>
<area shape="rect" href="_can_a_c_8cpp.html#aa03215296e449dcccc448cf6a8e345d3" title=" " alt="" coords="13,56,75,83"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_567355a66c5b87dfe03a58cbdce72993.html">module_library</a></li><li class="navelem"><a class="el" href="ball__berry__gs_8h.html">ball_berry_gs.h</a></li>
    <li class="footer">Generated on Thu Oct 26 2023 02:56:12 for The BioCro C++ Library by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
