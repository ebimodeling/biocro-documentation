<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The BioCro C++ Library: /github/workspace/src/module_library/lightME.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">The BioCro C++ Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('light_m_e_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">lightME.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="light_m_e_8h_source.html">lightME.h</a>&quot;</code><br />
<code>#include &quot;../framework/constants.h&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for lightME.cpp:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="light_m_e_8cpp__incl.png" border="0" usemap="#a_2github_2workspace_2src_2module__library_2light_m_e_8cpp" alt=""/></div>
<map name="a_2github_2workspace_2src_2module__library_2light_m_e_8cpp" id="a_2github_2workspace_2src_2module__library_2light_m_e_8cpp">
<area shape="rect" title=" " alt="" coords="25,5,205,47"/>
<area shape="rect" href="light_m_e_8h.html" title=" " alt="" coords="5,95,80,121"/>
<area shape="rect" title=" " alt="" coords="105,95,269,121"/>
</map>
</div>
</div>
<p><a href="light_m_e_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa0300eb80fe3110f7747ed1bdbaef69b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_light__model.html">Light_model</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="light_m_e_8cpp.html#aa0300eb80fe3110f7747ed1bdbaef69b">lightME</a> (double cosine_zenith_angle, double atmospheric_pressure, double atmospheric_transmittance, double atmospheric_scattering)</td></tr>
<tr class="memdesc:aa0300eb80fe3110f7747ed1bdbaef69b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the "light macro environment"; in other words, the amount of sunlight scattered out of the direct beam by the atmosphere.  <a href="light_m_e_8cpp.html#aa0300eb80fe3110f7747ed1bdbaef69b">More...</a><br /></td></tr>
<tr class="separator:aa0300eb80fe3110f7747ed1bdbaef69b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="aa0300eb80fe3110f7747ed1bdbaef69b" name="aa0300eb80fe3110f7747ed1bdbaef69b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0300eb80fe3110f7747ed1bdbaef69b">&#9670;&nbsp;</a></span>lightME()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_light__model.html">Light_model</a> lightME </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cosine_zenith_angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>atmospheric_pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>atmospheric_transmittance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>atmospheric_scattering</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the "light macro environment"; in other words, the amount of sunlight scattered out of the direct beam by the atmosphere. </p>
<p >The result is expressed in two ways:</p>
<ol type="1">
<li>As atmospheric transmittances, which are the ratios of direct light or diffuse light at the Earth's surface to incident light at the upper atmosphere. These would be appropriate for calculating the intensity of direct and diffuse light at the surface given a value for the solar constant. Note that these transmittances are different than the input parameter <code>atmospheric_transmittance</code>, which represents the transmittance of either type of light through a small volume of atmosphere.</li>
<li>As fractions of direct and diffuse light at the Earth's surface, which would be appropriate for calculating the intensity of direct and diffuse light given an experimental measurement of light intensity at the surface.</li>
</ol>
<p >The basis for this function is given in chapter 11 of Norman and Campbell, <em>An Introduction to Environmental Biophysics</em>, 2nd edition. The book states that this model is technically only applicable for solar zenith angles less than 80 degrees (which approximately corresponds to <code>cosine_zenith_angle</code> greater than 0.173). When the Sun is closer to the horizon (or even below it), atmospheric refraction plays a large role in determining the relative amounts of direct and diffuse light at the Earth's surface. The effect of refraction depends strongly on dust, air temperature, and clouds, making it difficult or impossible to accurately model. Here, we choose to use the model outside this range, extending it to <code>cosine_zenith_angle = 0</code>. For even smaller values, we simply use the limits as <code>cosine_zenith_angle</code> approaches zero. The resulting inaccuracies are expected to play a small role in a biological simulation, because light intensities at the surface tend to be low when the Sun is near the horizon.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cosine_zenith_angle</td><td>The cosine of the solar zenith angle; when the Sun is directly overhead, the angle is 0 and its cosine is 1; when the Sun's center is at the horizon, the angle is 90 and its cosine is 0.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atmospheric_pressure</td><td>Local atmospheric pressure in Pa</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atmospheric_transmittance</td><td>Fraction of light transmitted through a small volume of atmosphere (dimensionless)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atmospheric_scattering</td><td>Atmospheric scattering factor (dimensionless)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A structure containing values of the transmittances and fractions of direct and diffuse light just above the canopy. </dd></dl>

<p class="definition">Definition at line <a class="el" href="light_m_e_8cpp_source.html#l00056">56</a> of file <a class="el" href="light_m_e_8cpp_source.html">lightME.cpp</a>.</p>

<p class="reference">References <a class="el" href="light_m_e_8h_source.html#l00002">Light_model::direct_transmittance</a>.</p>

<p class="reference">Referenced by <a class="el" href="c3_can_a_c_8cpp_source.html#l00008">c3CanAC()</a>, <a class="el" href="_can_a_c_8cpp_source.html#l00008">CanAC()</a>, and <a class="el" href="shortwave__atmospheric__scattering_8h_source.html#l00079">shortwave_atmospheric_scattering::do_operation()</a>.</p>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="light_m_e_8cpp_aa0300eb80fe3110f7747ed1bdbaef69b_icgraph.png" border="0" usemap="#alight_m_e_8cpp_aa0300eb80fe3110f7747ed1bdbaef69b_icgraph" alt=""/></div>
<map name="alight_m_e_8cpp_aa0300eb80fe3110f7747ed1bdbaef69b_icgraph" id="alight_m_e_8cpp_aa0300eb80fe3110f7747ed1bdbaef69b_icgraph">
<area shape="rect" title="Calculates the &quot;light macro environment&quot;; in other words, the amount of sunlight scattered out of the..." alt="" coords="436,74,501,101"/>
<area shape="rect" href="c3_can_a_c_8cpp.html#a5ae95949fd0f55e5d42bc4c4f0f6e052" title=" " alt="" coords="266,19,343,46"/>
<area shape="rect" href="_can_a_c_8cpp.html#aa03215296e449dcccc448cf6a8e345d3" title=" " alt="" coords="273,74,336,101"/>
<area shape="rect" href="classstandard_b_m_l_1_1shortwave__atmospheric__scattering.html#a391e9fd4e949f6e987eb654a11b1e451" title=" " alt="" coords="221,125,388,181"/>
<area shape="rect" href="classstandard_b_m_l_1_1c3__canopy.html#a391e9fd4e949f6e987eb654a11b1e451" title=" " alt="" coords="5,5,173,47"/>
<area shape="rect" href="classstandard_b_m_l_1_1c4__canopy.html#a391e9fd4e949f6e987eb654a11b1e451" title=" " alt="" coords="5,71,173,112"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_567355a66c5b87dfe03a58cbdce72993.html">module_library</a></li><li class="navelem"><a class="el" href="light_m_e_8cpp.html">lightME.cpp</a></li>
    <li class="footer">Generated on Thu Oct 26 2023 02:55:54 for The BioCro C++ Library by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
