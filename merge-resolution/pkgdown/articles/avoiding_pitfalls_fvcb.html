<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="BioCro">
<title>Avoiding Pitfalls When Using the FvCB Model • BioCro</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Avoiding Pitfalls When Using the FvCB Model">
<meta property="og:description" content="BioCro">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BioCro</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../about_pkgdown_documentation.html">About</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>GENERAL BIOCRO USAGE</h6>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/a_practical_guide_to_biocro.pdf">A Practical Guide to BioCro (PDF)</a>
    <a class="dropdown-item" href="../articles/a_practical_guide_to_biocro.R">    [R code]</a>
    <a class="dropdown-item" href="../articles/quantitative_model_comparison.pdf">Quantitative Comparison Between Two Photosynthesis Models (PDF)</a>
    <a class="dropdown-item" href="../articles/quantitative_model_comparison.R">    [R code]</a>
    <a class="dropdown-item" href="../articles/BioCro-II_Paper--Section-1.1-example.html">BioCro II Paper: Section 1.1 Example (HTML)</a>
    <a class="dropdown-item" href="../articles/dynamical_systems.pdf">BioCro as a Dynamical System</a>
    <a class="dropdown-item" href="../articles/an_introduction_to_biocro.pdf">An Introduction to BioCro for Those Who Want to Add Models (PDF)</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>CROP GROWTH MODELING TOPICS</h6>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/avoiding_pitfalls_fvcb.html">Avoiding Pitfalls When Using the FvCB Model (HTML)</a>
    <a class="dropdown-item" href="../articles/thick_layer_absorption.html">Light Absorption by a Thick Layer (HTML)</a>
    <a class="dropdown-item" href="../articles/ball_berry_model.html">Using the Ball-Berry Model (HTML)</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../bookdown/index.html">Developer's Manual</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-c-library">C++ Library</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-c-library">
    <a class="dropdown-item" href="../../doxygen/doxygen_docs_complete/index.html">Complete Doxygen Documentation</a>
    <a class="dropdown-item" href="../../doxygen/doxygen_docs_framework/index.html">Framework Documentation</a>
    <a class="dropdown-item" href="../../doxygen/doxygen_docs_modules/index.html">BioCro Module Documentation</a>
    <a class="dropdown-item" href="../../doxygen/doxygen_docs_modules_public_members_only/index.html">BioCro Module Documentation (public members only)</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ebimodeling/biocro/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Avoiding Pitfalls When Using the FvCB Model</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ebimodeling/biocro/blob/HEAD/vignettes/avoiding_pitfalls_fvcb.Rmd" class="external-link"><code>vignettes/avoiding_pitfalls_fvcb.Rmd</code></a></small>
      <div class="d-none name"><code>avoiding_pitfalls_fvcb.Rmd</code></div>
    </div>

    
    
<div class="section level2" number="1">
<h2 id="overview">
<span class="header-section-number">1</span> Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The Farquhar-von-Caemmerer-Berry (FvCB) model for C<sub>3</sub> photosynthesis was first
presented in <span class="citation">Farquhar et al. (<a href="#ref-farquhar_biochemical_1980" role="doc-biblioref">1980</a>)</span>, and since that initial publication, it
has become one of the most important models for understanding the photosynthetic
response of plants to key environmental variables such as incident light, CO<sub>2</sub>,
and temperature. Many researchers are familiar with the model in the contex of
fitting it to experimentally measured CO<sub>2</sub> response curves, where certain
simplifying assumptions can be reasonably applied to the model. However, these
assumptions are not reasonable when using the model in a wider range of
conditions than those usually encountered during gas exchange measurements. The
goal of this document is to identify several possible pitfalls associated with
these assumptions and explain how to avoid them when using the FvCB model.</p>
</div>
<div class="section level2" number="2">
<h2 id="sec:centraleq">
<span class="header-section-number">2</span> The Central FvCB Equation<a class="anchor" aria-label="anchor" href="#sec:centraleq"></a>
</h2>
<p>The FvCB model is rooted in a biochemical understanding of the photosynthetic
process, especially the carboxylation (or oxygenation) of RuBP by the enzyme
Rubisco. At its core, it predicts the net CO<sub>2</sub> assimilation rate (<span class="math inline">\(A_n\)</span>) from
the values of several key variables. An initial equation for <span class="math inline">\(A_n\)</span> can be
developed from the following considerations:</p>
<ul>
<li><p>One carboxylation of RuBP assimilates one molecule of CO<sub>2</sub>.</p></li>
<li><p>Two oxygenations of RuBP produces hazardous byproducts that require the
release of one molecule of CO<sub>2</sub> to neutralize. (Oxygenation of RuBP is often
referred to as <em>photorespiration</em>.)</p></li>
<li><p>Mitochondrial respiration also releases CO<sub>2</sub> molecules.</p></li>
</ul>
<p>Putting this all together, we can write down an initial equation for the net
assimilation rate:
<span class="math display" id="eq:an">\[\begin{equation}
A_n = V_c - 0.5 \cdot V_o - R_d, \tag{2.1}
\end{equation}\]</span>
where <span class="math inline">\(V_c\)</span> is the RuBP carboxylation rate, <span class="math inline">\(V_o\)</span> is the RuBP oxygenation rate,
and <span class="math inline">\(R_d\)</span> is the mitochondrial respiration rate. As written, <span class="math inline">\(V_c\)</span>, <span class="math inline">\(V_o\)</span>, and
<span class="math inline">\(R_d\)</span> are all non-negative rates, typically with units of <span class="math inline">\(\mu\)</span>mol m<span class="math inline">\(^{-2}\)</span>
s<span class="math inline">\(^{-1}\)</span>. The first two terms in the equation (<span class="math inline">\(V_c - 0.5 \cdot V_o\)</span>)
represent the contribution of photosynthesis (or Rubisco) to the net CO<sub>2</sub>
assimilation, while the remaining term (<span class="math inline">\(-R_d\)</span>) is the result of mitochondrial
respiration, a separate process.</p>
<p>In its current form, this equation is not very easy to interpret or use. There
are a few modifications we can use to improve it. One change is to introduce
<span class="math inline">\(\phi\)</span>, the ratio of RuBP oxygenation to carboxylation: <span class="math inline">\(\phi = V_o / V_c\)</span>. Now
we can rewrite Equation <a href="#eq:an">(2.1)</a> as follows:
<span class="math display" id="eq:anphi">\[\begin{equation}
A_n = V_c \cdot \left( 1 - 0.5 \cdot \phi \right) - R_d. \tag{2.2}
\end{equation}\]</span></p>
<p>This version of the equation makes it clear that <span class="math inline">\(\phi\)</span> plays a key role in
determining whether RuBP carboxylation is able to outweigh oxygenation; in other
words, it determines whether the photosynthetic contribution to the net CO<sub>2</sub>
assimilation rate is positive or negative. If <span class="math inline">\(1 - 0.5 \cdot \phi &lt; 0\)</span>, then
oxygenation consumes more carbon than carboxylation produces; if
<span class="math inline">\(1 - 0.5 \cdot \phi &gt; 0\)</span>, then the opposite is true. The crossover point where
carboxylation and oxygenation exactly cancel each other out occurs when
<span class="math inline">\(1 - 0.5 \cdot \phi = 0\)</span>. It can be shown that <span class="math inline">\(\phi\)</span> depends on the relative
specificity of Rubisco for CO<sub>2</sub> versus O<sub>2</sub> (<span class="math inline">\(S_{c/o}\)</span>), the partial pressure
of CO<sub>2</sub> in the vicinity of Rubisco (<span class="math inline">\(C\)</span>), and the partial pressure of O<sub>2</sub> in
the vicinity of Rubisco (<span class="math inline">\(O\)</span>):
<span class="math display" id="eq:s">\[\begin{equation}
\phi = \frac{1}{S_{c/o}} \cdot \frac{O}{C}. \tag{2.3}
\end{equation}\]</span>
(See, for example, Equation 2.16 from <span class="citation">von Caemmerer (<a href="#ref-caemmerer_biochemical_2000" role="doc-biblioref">2000</a>)</span> and the
surrounding discussion.)</p>
<p>Equation <a href="#eq:s">(2.3)</a> tells us that when the amount of CO<sub>2</sub> near Rubisco
increases, or when Rubisco’s specificity for CO<sub>2</sub> increases, <span class="math inline">\(\phi\)</span> decreases
and hence the oxygenation rate also decreases. This makes sense at an intuitive
level. It also helps to clarify the criteria for photosynthesis to become a net
producer of assimilated carbon. One immediate conclusion is that because
Rubisco specificity and oxygen levels are generally constant for a particular
chloroplast, the only reasonable way to change <span class="math inline">\(\phi\)</span> is to change <span class="math inline">\(C\)</span>. But we
can still learn more. We have already seen that the crossover occurs when
<span class="math inline">\(1 - 0.5 \cdot \phi = 0\)</span> or, equivalently, when <span class="math inline">\(\phi = 2\)</span>. Now, we can rewrite
this condition using <a href="#eq:s">(2.3)</a>:
<span class="math display">\[\begin{equation}
\phi = 2 \\
\rightarrow \frac{1}{S_{c/o}} \cdot \frac{O}{C} = 2 \\
\rightarrow C = \frac{O}{2 \cdot S_{c/o}}.
\end{equation}\]</span></p>
<p>In other words, photosynthesis is a net producer of carbon whenever <span class="math inline">\(C\)</span> exceeds
a special value called <span class="math inline">\(\Gamma^*\)</span> defined by:
<span class="math display" id="eq:gstar">\[\begin{equation}
\Gamma^* = \frac{O}{2 \cdot S_{c/o}}. \tag{2.4}
\end{equation}\]</span>
<span class="math inline">\(\Gamma^*\)</span> is often referred to as the “CO<sub>2</sub> compensation point in the absence
of mitochondrial respiration.” (In general, the term “CO<sub>2</sub> compensation point”
refers to the value of <span class="math inline">\(C\)</span> where <span class="math inline">\(A_n = 0\)</span>.) Note that since atmospheric oxygen
levels are fairly constant, <span class="math inline">\(O\)</span> rarely changes under most conditions, so
<span class="math inline">\(\Gamma^*\)</span> is largely a property of Rubisco; more specifically, it depends
primarily on <span class="math inline">\(S_{c/o}\)</span>. (The major exception to this is when <span class="math inline">\(O\)</span> is artificially
decreased during gas exchange measurements in order to reduce <span class="math inline">\(V_o\)</span>.)</p>
<p>With this new concept, we can use Equations <a href="#eq:s">(2.3)</a> and <a href="#eq:gstar">(2.4)</a> to
rewrite Equation <a href="#eq:anphi">(2.2)</a> as follows:
<span class="math display" id="eq:anfinal">\[\begin{equation}
A_n = V_c \cdot (1 - \Gamma^* / C) - R_d \tag{2.5}
\end{equation}\]</span>
This equation contains a great deal of useful information, and we will refer to
it as the central equation of the FvCB model. (This is our terminology, and not
a standard name for the equation.) It can be found in many notable descriptions
of the FvCB model, such as:</p>
<ul>
<li><p>Equation 16.57 in <span class="citation">Farquhar and von Caemmerer (<a href="#ref-farquhar_modelling_1982" role="doc-biblioref">1982</a>)</span>.</p></li>
<li><p>Equation 1 in <span class="citation">Kirschbaum and Farquhar (<a href="#ref-kirschbaum_temperature_1984" role="doc-biblioref">1984</a>)</span>.</p></li>
<li><p>Equation 2.19 in <span class="citation">von Caemmerer (<a href="#ref-caemmerer_biochemical_2000" role="doc-biblioref">2000</a>)</span>.</p></li>
<li><p>Equation A6 in <span class="citation">von Caemmerer (<a href="#ref-von_caemmerer_steady-state_2013" role="doc-biblioref">2013</a>)</span>.</p></li>
</ul>
<p>(A big exception is the original FvCB paper <span class="citation">(<a href="#ref-farquhar_biochemical_1980" role="doc-biblioref">Farquhar et al. 1980</a>)</span>, which
does not contain this equation!)</p>
<p>A key piece of information that can be learned from this equation is that while
the RuBP carboxylation rate <span class="math inline">\(V_c\)</span> can never be negative, the contribution of
photosynthesis to the net assimilation rate (<span class="math inline">\(V_c \cdot(1 - \Gamma^* / C)\)</span>)
<em>can</em> be negative; this will occur whenever <span class="math inline">\(V_c &gt; 0\)</span> and <span class="math inline">\(C &lt; \Gamma^*\)</span>.</p>
<p>The rest of the FvCB model consists of a method for calculating <span class="math inline">\(V_c\)</span>; this will
be discussed in the following sections.</p>
</div>
<div class="section level2" number="3">
<h2 id="choosing-a-carboxylation-rate">
<span class="header-section-number">3</span> Choosing a Carboxylation Rate<a class="anchor" aria-label="anchor" href="#choosing-a-carboxylation-rate"></a>
</h2>
<p>In the original FvCB model, two scenarios are considered when determining the
RuBP carboxylation rate <span class="math inline">\(V_c\)</span>:</p>
<ul>
<li><p>When there is plenty of RuBP available for Rubisco to act upon, the
carboxylation rate is said to be RuBP-saturated (or Rubisco-limited). In this
case, it is common to denote the carboxylation rate by <span class="math inline">\(W_c\)</span>. The equation for
<span class="math inline">\(W_c\)</span> and its derivation can be found in many places, such as Equation 1.9 in
<span class="citation">von Caemmerer (<a href="#ref-caemmerer_biochemical_2000" role="doc-biblioref">2000</a>)</span> and the surrounding discussion.</p></li>
<li><p>Following a carboxylation or an oxygenation, each RuBP molecule must be
“regenerated,” that is, returned to its original state and ready for another
carboxylation or oxygenation. If the RuBP regeneration rate is too slow, it
may impose a new maximum on the carboxylation rate, which is said to be
RuBP-regeneration-limited. In this case, it is common to denote the
carboxylation rate by <span class="math inline">\(W_j\)</span>. The equation for <span class="math inline">\(W_j\)</span> and its derivation can be
found in many places, such as Equations 2.21 and 2.22 in
<span class="citation">von Caemmerer (<a href="#ref-caemmerer_biochemical_2000" role="doc-biblioref">2000</a>)</span> and the surrounding discussion. Sometimes this
rate is referred to as the electron-transport-limited rate, but this
terminology is becoming less common since it has been realized that other
factors besides electron transport can limit RuBP regeneration.</p></li>
</ul>
<p>For brevity, we will simply reproduce the equations here without their
derivations:
<span class="math display" id="eq:wc">\[\begin{equation}
W_c = \frac{V_{cmax} \cdot C}{C + K_c \cdot \left( 1 + O / K_o \right)} \tag{3.1}
\end{equation}\]</span>
and
<span class="math display" id="eq:wj">\[\begin{equation}
W_j = \frac{J \cdot C}{4 \cdot C + 8 \cdot \Gamma^*}, \tag{3.2}
\end{equation}\]</span>
where <span class="math inline">\(V_{cmax}\)</span> is the maximum rate of Rubisco carboxylation activity, <span class="math inline">\(K_c\)</span>
and <span class="math inline">\(K_o\)</span> are Michaelis-Menten constants for CO<sub>2</sub> and O<sub>2</sub>, and <span class="math inline">\(J\)</span> is the
RuBP regeneration rate, which may depend on several external factors such as the
incident irradiance. <span class="math inline">\(V_{cmax}\)</span>, <span class="math inline">\(K_c\)</span>, and <span class="math inline">\(K_o\)</span> are all positive, while <span class="math inline">\(J\)</span> is
non-negative.</p>
<p>Note that several different versions of Equation <a href="#eq:wj">(3.2)</a> can be found in
the literature, where the only changes are to the coefficients in the
denominator (<span class="math inline">\(4\)</span> and <span class="math inline">\(8\)</span> in our version; see Equation 16.60 in
<span class="citation">Farquhar and von Caemmerer (<a href="#ref-farquhar_modelling_1982" role="doc-biblioref">1982</a>)</span> or Section 2.4.2 from <span class="citation">von Caemmerer (<a href="#ref-caemmerer_biochemical_2000" role="doc-biblioref">2000</a>)</span> for
more information). These coefficients are related to energy requirements
involved with the electron transport chain, and different estimates exist for
these requirements. Because of these differences, the coefficients can sometimes
be considered as variables in the equation instead of taking fixed values.</p>
<p>One significant feature of Equations <a href="#eq:wc">(3.1)</a> and <a href="#eq:wj">(3.2)</a> is that
neither one can ever return a negative value, as expected (and required) for any
equation that calculates a carboxylation rate. Another important thing to notice
is that <span class="math inline">\(V_{cmax}\)</span>, <span class="math inline">\(K_c\)</span>, <span class="math inline">\(K_o\)</span>, <span class="math inline">\(O\)</span>, and <span class="math inline">\(\Gamma^*\)</span> are generally constant
within a chloroplast, so the main environmental influences on <span class="math inline">\(W_c\)</span> and <span class="math inline">\(W_j\)</span>
are <span class="math inline">\(C\)</span> and <span class="math inline">\(J\)</span>. As <span class="math inline">\(C\)</span> and <span class="math inline">\(J\)</span> vary, one or the other of <span class="math inline">\(W_c\)</span> and <span class="math inline">\(W_j\)</span> may
become the larger of the two.</p>
<p>At this point, a key question needs to be addressed: which carboxylation rate
(<span class="math inline">\(W_c\)</span> or <span class="math inline">\(W_j\)</span>) should be used in Equation <a href="#eq:anfinal">(2.5)</a> to determine the
net CO<sub>2</sub> assimilation rate? The FvCB authors provide an answer: we should
choose whichever rate is smaller for the current set of conditions (as specified
by <span class="math inline">\(C\)</span>, <span class="math inline">\(J\)</span>, etc). Intuitively, this makes sense. It doesn’t matter how many
RuBP molecules could be carboxylated by Rubisco if the RuBP is not being
regenerated fast enough; alternatively, it doesn’t matter how many RuBP
molecules are being regenerated if Rubisco is unable to carboxylate them.
Converting this idea to mathematical form, we arrive at another essential
equation:
<span class="math display" id="eq:mincj">\[\begin{equation}
V_c = \min \{ W_c, W_j \} \tag{3.3}
\end{equation}\]</span></p>
<p>This is the most common way to choose between the rates, but it does produce
very sudden transitions between RuBP-saturated and RuBP-regeneration-limited
carboxylation. Sometimes alternatives to a simple minimum are used, such as a
quadratic mixing method, that produce smoother transitions. For example, see
<span class="citation">Kirschbaum and Farquhar (<a href="#ref-kirschbaum_temperature_1984" role="doc-biblioref">1984</a>)</span>.</p>
<div class="section level3" number="3.1">
<h3 id="sec:pitfallci">
<span class="header-section-number">3.1</span> Pitfall: Limitations at Low CO<sub>2</sub> Concentration<a class="anchor" aria-label="anchor" href="#sec:pitfallci"></a>
</h3>
<p>People who are familiar with analyzing experimentally measured A-Ci curves may
be under the impression that at low <span class="math inline">\(C\)</span>, carboxylation (and hence net CO<sub>2</sub>
assimilation) is always RuBP-saturated (or Rubisco-limited). Here, “low <span class="math inline">\(C\)</span>” may
mean below <span class="math inline">\(\Gamma^*\)</span>, below the CO<sub>2</sub> compensation point, or possibly below
some other threshold. For example, a paper with an excellent discussion of C<sub>3</sub>
A-Ci curve fitting <span class="citation">(<a href="#ref-sharkey_fitting_2007" role="doc-biblioref">Sharkey et al. 2007</a>)</span> includes the following discussion of
limitations to assimilation:</p>
<blockquote>
<p>The routine described here requires identifying whether a data point is
limited by Rubisco, RuBP regeneration or <em>TPU</em>. A good starting point is to
assign points above 30 Pa as RuBP-regeneration-limited and points below 20 Pa
as Rubisco-limited; points between 20 and 30 Pa might be either.</p>
</blockquote>
<p>While this may be good advice for interpreting an A-Ci curve, it is not
generally true, and instead relies on an unstated assumption that <span class="math inline">\(J\)</span> is quite
high (an assumption often met while measuring an A-Ci curve).</p>
<p>There is nothing in the FvCB model equations (Equations <a href="#eq:anfinal">(2.5)</a>,
<a href="#eq:wc">(3.1)</a>, <a href="#eq:wj">(3.2)</a>, and <a href="#eq:mincj">(3.3)</a>) that enforces <span class="math inline">\(W_c &lt; W_j\)</span> below
some threshold value of <span class="math inline">\(C\)</span>. In fact, there is a simple counterexample
demonstrating a situation where <span class="math inline">\(W_j &lt; W_c\)</span> at low <span class="math inline">\(C\)</span>: darkness. Darkness
ensures that <span class="math inline">\(J = 0\)</span> and hence <span class="math inline">\(W_j \leq W_c\)</span> for all values of <span class="math inline">\(C\)</span>.</p>
<p>It is possible to find the point where the process limiting the carboxylation
rate changes; this can be done by setting <span class="math inline">\(W_c = W_j\)</span> and solving for <span class="math inline">\(C\)</span>. The
result is given by Equation 2.52 in <span class="citation">von Caemmerer (<a href="#ref-caemmerer_biochemical_2000" role="doc-biblioref">2000</a>)</span>, where this
special value of <span class="math inline">\(C\)</span> is called <span class="math inline">\(C_c\)</span>:
<span class="math display" id="eq:cc">\[\begin{equation}
C_c = \frac{K_c \cdot \left( 1 + O / K_o \right) \cdot J / \left( 4 \cdot V_{cmax} \right) - 2 \cdot \Gamma^*}{1 - J / \left( 4 \cdot V_{cmax} \right)} \tag{3.4}
\end{equation}\]</span>
From a physical point of view, <span class="math inline">\(C_c\)</span> cannot be negative; however, Equation
<a href="#eq:cc">(3.4)</a> can mathematically produce negative values for <span class="math inline">\(C_c\)</span>. When this
happens, it simply means that there is no crossover, and one or the other
process limits carboxylation for all realistic values of <span class="math inline">\(C\)</span>. This occurs
whenever the denominator and numerator have opposite signs. The denominator
becomes negative when <span class="math inline">\(4 \cdot V_{cmax} &lt; J\)</span>. This is a situation where
<span class="math inline">\(V_{cmax}\)</span> is small and carboxylation is always RuBP-saturated. On the other
hand, the numerator becomes negative when
<span class="math inline">\(J &lt; 8 \cdot V_{cmax} \cdot \Gamma^* / \left[ K_c \cdot \left( 1 + O / K_o \right) \right]\)</span>.
This is a situation where <span class="math inline">\(J\)</span> is small and carboxylation is always
RuBP-regeneration-limited. (Of course, <span class="math inline">\(C_c\)</span> will be positive if both the
numerator and denominator are negative, but this is unlikely to happen for
realistic values of <span class="math inline">\(K_c\)</span>, <span class="math inline">\(K_o\)</span>, <span class="math inline">\(O\)</span>, and <span class="math inline">\(\Gamma^*\)</span>.) Even when <span class="math inline">\(C_c\)</span> is
positive, it may not be realistically obtainable; for example, if <span class="math inline">\(J\)</span> is just a
tiny bit smaller than <span class="math inline">\(4 \cdot Vcmax\)</span>, <span class="math inline">\(C_c\)</span> can take very large values that
would only be achievable in a gas evironment of nearly pure CO<sub>2</sub>. Essentially,
this analysis of Equation <a href="#eq:cc">(3.4)</a> tells us that there is no simple rule for
determining which process limits carboxylation in the FvCB model, and it is even
possible that a crossover between limiting processes may not occur (see Figure
<a href="#fig:cc">3.1</a>).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:cc"></span>
<img src="avoiding_pitfalls_fvcb_files/figure-html/cc-1.png" alt="Solution space of Equation \@ref(eq:cc) indicating where a  crossover is impossible because `Cc` is negative (pink), unlikely because  `Cc` is too large (dark blue), or otherwise possible (white). The upper  pink region is bounded from below by  `Vcmax = J * [ Kc * (1 + O / Ko)] / (8 * GammaStar)` and the lower pink  region is bounded from above by `Vcmax = J / 4`. In this calculation,  `Kc` = 259 microbar, `O` = 200 mbar, `Ko` = 179 mbar, `GammaStar` =  38.6 microbar, and `Cc` is considered to be too large when it exceeds  2000 microbar."><p class="caption">
Figure 3.1: Solution space of Equation <a href="#eq:cc">(3.4)</a> indicating where a crossover is impossible because <code>Cc</code> is negative (pink), unlikely because <code>Cc</code> is too large (dark blue), or otherwise possible (white). The upper pink region is bounded from below by <code>Vcmax = J * [ Kc * (1 + O / Ko)] / (8 * GammaStar)</code> and the lower pink region is bounded from above by <code>Vcmax = J / 4</code>. In this calculation, <code>Kc</code> = 259 microbar, <code>O</code> = 200 mbar, <code>Ko</code> = 179 mbar, <code>GammaStar</code> = 38.6 microbar, and <code>Cc</code> is considered to be too large when it exceeds 2000 microbar.
</p>
</div>
</div>
<div class="section level3" number="3.2">
<h3 id="sec:pitfallassim">
<span class="header-section-number">3.2</span> Pitfall: Choosing Minimal Assimilation Rates<a class="anchor" aria-label="anchor" href="#sec:pitfallassim"></a>
</h3>
<p>When carboxylation is RuBP-saturated, the corresponding net CO<sub>2</sub> assimilation
rate (called <span class="math inline">\(A_c\)</span> rather than <span class="math inline">\(A_n\)</span> to indicate the type of limitation) can be
found by combining Equations <a href="#eq:anfinal">(2.5)</a> and <a href="#eq:wc">(3.1)</a> as follows:
<span class="math display" id="eq:ac">\[\begin{equation}
A_c = W_c \cdot (1 - \Gamma^* / C) - R_d = \frac{V_{cmax} \cdot \left( C - \Gamma^* \right)}{C + K_c \cdot \left( 1 + O / K_o \right)} - R_d. \tag{3.5}
\end{equation}\]</span>
Likewise, when carboxylation is RuBP-regeneration-limited, the corresponding net
CO<sub>2</sub> assimilation rate (called <span class="math inline">\(A_j\)</span>) can be found by combining Equations
<a href="#eq:anfinal">(2.5)</a> and <a href="#eq:wj">(3.2)</a> as follows:
<span class="math display" id="eq:aj">\[\begin{equation}
A_j = W_j \cdot (1 - \Gamma^* / C) - R_d = \frac{J \cdot \left( C - \Gamma^* \right)}{4 \cdot C + 8 \cdot \Gamma^*} - R_d. \tag{3.6}
\end{equation}\]</span></p>
<p>With this in mind, the FvCB model is sometimes expressed in the following form,
which is a bit simpler than using the version above because it bypasses the
separate calculation of carboxylation rates and only requires three equations
instead of four:
<span class="math display" id="eq:analt">\[\begin{equation}
A_n = \min \{ A_c, A_j \}. \tag{3.7}
\end{equation}\]</span>
This equation can be found in many publications, and the earliest instance may
be Equation A1 from <span class="citation">Collatz et al. (<a href="#ref-collatz_physiological_1991" role="doc-biblioref">1991</a>)</span>. In that paper, the authors
state</p>
<blockquote>
<p>Equation (A1) is equivalent in form to that proposed by Kirschbaum and
Farquhar (1984), but our definitions of <span class="math inline">\(J_C\)</span>, <span class="math inline">\(J_E\)</span>, and <span class="math inline">\(J_S\)</span> differ
somewhat from theirs.</p>
</blockquote>
<p>(Note that <span class="citation">Kirschbaum and Farquhar (<a href="#ref-kirschbaum_temperature_1984" role="doc-biblioref">1984</a>)</span> uses <span class="math inline">\(W_c\)</span> and <span class="math inline">\(W_j\)</span>, as mentioned
above.) Unfortunately, the claim from this paper is simply untrue because
Equations <a href="#eq:anfinal">(2.5)</a> and <a href="#eq:mincj">(3.3)</a> produce different results from
Equation <a href="#eq:analt">(3.7)</a>.</p>
<p>To see why, suppose that <span class="math inline">\(W_c &lt; W_j\)</span> and <span class="math inline">\(C &lt; \Gamma^*\)</span>. In this case,
<span class="math inline">\(\min \{ W_c, W_j \} = W_c\)</span> and so <span class="math inline">\(A_n = A_c\)</span> according to the FvCB model.
However, <span class="math inline">\(1 - \Gamma^* / C\)</span> is negative, so
<span class="math inline">\(A_c = W_c \cdot \left( 1 - \Gamma^* / C \right) - R_d\)</span> is also negative.
Likewise, <span class="math inline">\(A_j\)</span> is negative, but its magnitude is larger than <span class="math inline">\(A_c\)</span> because
<span class="math inline">\(W_c &lt; W_j\)</span>. So, in this case, <span class="math inline">\(\min \{ A_c, A_j \} = A_j\)</span>. Thus, Equation
<a href="#eq:analt">(3.7)</a> has chosen the incorrect limiting factor. In fact, Equation
<a href="#eq:analt">(3.7)</a> <em>always</em> chooses the wrong limiting factor when <span class="math inline">\(C &lt; \Gamma^*\)</span>.</p>
<p>When Equation <a href="#eq:analt">(3.7)</a> is implemented in computer code to aid with
fitting A-Ci curves or simulating photosynthesis, it is often paired with an
additional condition like <code>if (Aj &lt; 0) {Aj = 0}</code>. This is an attempt to fix the
problem of Equation <a href="#eq:analt">(3.7)</a> choosing the wrong limiting factor at low
<span class="math inline">\(C\)</span>. Unfortunately, this solution is based on another misunderstanding where it
is incorrectly assumed that carboxylation is always RuBP-saturated at low <span class="math inline">\(C\)</span>
(see Section <a href="#sec:pitfallci">3.1</a>). Although this “partial solution” might not
cause any problems when fitting A-Ci curves, it will not produce the FvCB
model’s true output when <span class="math inline">\(J\)</span> is low.</p>
<p>Because of this subtle issue for <span class="math inline">\(C &lt; \Gamma^*\)</span>, it is better to avoid Equation
<a href="#eq:analt">(3.7)</a> in favor of Equations <a href="#eq:anfinal">(2.5)</a> and <a href="#eq:mincj">(3.3)</a>.
Although Equation <a href="#eq:analt">(3.7)</a> may seem like it is simply an alternative way
to specify the FvCB model, it is actually not, and it would be more accurate to
consider it as a separate “pseudo-FvCB” model, a term we will continue to use in
the rest of this document. Examples comparing the FvCB model against the
pseudo-FvCB model can be found in Section <a href="#sec:examples">6</a>.</p>
</div>
</div>
<div class="section level2" number="4">
<h2 id="including-triose-phosphate-utilization">
<span class="header-section-number">4</span> Including Triose Phosphate Utilization<a class="anchor" aria-label="anchor" href="#including-triose-phosphate-utilization"></a>
</h2>
<p>The sum of the chemical reactions in the Calvin–Benson–Bassham (CBB) cycle can
be written as
<span class="math display" id="eq:cbb">\[\begin{multline}
\qquad 3 \, \mathrm{CO_2} + 6 \, \mathrm{NADPH} + 6 \, \mathrm{H^+} +  9 \, \mathrm{ATP} + 5 \, \mathrm{H_2O} \rightarrow \\
\mathrm{(G3P)} + 6 \, \mathrm{NADP^+} + 9 \, \mathrm{ADP} + 8 \, \mathrm{P_i}, \qquad \tag{4.1}
\end{multline}\]</span>
where G3P refers to glyceraldehyde 3-phosphate (also known as triose phosphate)
and P<sub>i</sub> refers to inorganic phosphate (an ion). Each molecule of ATP is
synthesized from three inorganic phosphate ions; thus, the CBB reaction requires
nine P<sub>i</sub> ions, eight of which remain free at the end. The missing inorganic
phosphate is contained in the triose phosphate molecule, which is exported from
the chloroplast and eventually used to form monosaccharide sugars. Since the CBB
reaction requires three CO<sub>2</sub> molecules, each of which originate from a RuBP
carboxylation, we can see that each carboxylation effectively consumes one third
of an inorganic phosphate. By separately considering the impact of RuBP
oxygenation (not included here), it can be shown that the overall rate of
inorganic phosphate consumption during photosynthesis (<span class="math inline">\(R_{pc}\)</span>) can be given by
<span class="math display">\[\begin{equation}
R_{pc} = \frac{V_c}{3} - \frac{V_o}{6} - \frac{\alpha \cdot V_o}{2},
\end{equation}\]</span>
where <span class="math inline">\(0 \leq \alpha \leq 1\)</span> is the fraction of glycolate carbon not returned to
the chloroplast (see Section 2.4.3 in <span class="citation">von Caemmerer (<a href="#ref-caemmerer_biochemical_2000" role="doc-biblioref">2000</a>)</span>). As in
Section <a href="#sec:centraleq">2</a>, we can use <span class="math inline">\(V_o = \phi \cdot V_c\)</span> and
<span class="math inline">\(\phi / 2 = \Gamma^* / C\)</span> to rewrite this equation in terms of <span class="math inline">\(\Gamma^*\)</span> and
<span class="math inline">\(C\)</span>:
<span class="math display" id="eq:rpc">\[\begin{equation}
R_{pc} = \frac{V_c}{3 \cdot C} \cdot \left[ C - \Gamma^* \left( 1 + 3 \cdot \alpha \right) \right].  \tag{4.2}
\end{equation}\]</span></p>
<p>The inorganic phosphate supply is replenished when triose phosphate is used to
form sugars; although it happens elsewhere, the inorganic phosphate liberated
during this reaction is returned to the chloroplast. Under some circumstances,
the rate of triose phosphate utilization (TPU) is slow enough to limit the
inorganic phosphate available for use in the choloroplast for photosynthesis; in
this case, the carboxylation rate is said to be TPU-limited and <span class="math inline">\(R_{pc} = T_p\)</span>,
where <span class="math inline">\(T_p\)</span> is the rate of triose phosphate utilization. The expression for
<span class="math inline">\(R_{pc}\)</span> from Equation <a href="#eq:rpc">(4.2)</a> can be substuted into <span class="math inline">\(R_{pc} = T_p\)</span> and
solved for the corresponding carboxylation rate, which is referred to as <span class="math inline">\(W_p\)</span>
in this case:
<span class="math display" id="eq:wp">\[\begin{equation}
W_p = \frac{3 \cdot T_p \cdot C}{C - \Gamma^* \cdot \left( 1 + 3 \cdot \alpha \right)}. \tag{4.3}
\end{equation}\]</span></p>
<p>This represents a third possible limitation to the carboxylation rate in
addition to the RuBP-saturated and RuBP-regeneration-limited rates. While this
limitation was not included in the original FvCB model, its importance was
realized soon afterwards <span class="citation">(<a href="#ref-sharkey_photosynthesis_1985" role="doc-biblioref">Sharkey 1985</a>; <a href="#ref-harley_improved_1991" role="doc-biblioref">Harley and Sharkey 1991</a>)</span>
and it has since become a standard part of the model. Since we are now
considering a new process in the model, we must update Equation <a href="#eq:mincj">(3.3)</a>
to include <span class="math inline">\(W_p\)</span>:
<span class="math display" id="eq:mincjp">\[\begin{equation}
V_c = \min \{ W_c, W_j, W_p \}. \tag{4.4}
\end{equation}\]</span></p>
<div class="section level3" number="4.1">
<h3 id="pitfall-impossible-limitations">
<span class="header-section-number">4.1</span> Pitfall: Impossible Limitations<a class="anchor" aria-label="anchor" href="#pitfall-impossible-limitations"></a>
</h3>
<p>Inspecting Equation <a href="#eq:wp">(4.3)</a>, we can see that when
<span class="math inline">\(C &lt; \Gamma^* \cdot \left( 1 + 3 \cdot \alpha \right)\)</span>, the denominator of the
equation is negative, and hence <span class="math inline">\(W_p &lt; 0\)</span>. However, <span class="math inline">\(W_p\)</span> represents a
carboxylation rate, which cannot be negative. So what’s going on here? One way
to understand the situation is to evaluate Equation <a href="#eq:rpc">(4.2)</a> with
<span class="math inline">\(C\)</span> set to <span class="math inline">\(\Gamma^* \cdot \left( 1 + 3 \cdot \alpha \right)\)</span>. Doing so, we find
that the rate of inorganic phosphate consumption in this case is exactly 0. In
other words, when <span class="math inline">\(C\)</span> is low enough, photosynthesis is not consuming <em>any</em>
inorganic phosphate, and it is therefore impossible for carboxylation to be
limited by TPU. One way to indicate this restriction is to modify Equation
<a href="#eq:wp">(4.3)</a> to the following:
<span class="math display" id="eq:wpnew">\[\begin{equation}
  W_p =
  \begin{cases}
    \infty \;, &amp; 0 \leq C \leq \Gamma^* \cdot \left( 1 + 3 \cdot \alpha \right) \\[1ex]
    \frac{3 \cdot T_p \cdot C}{C - \Gamma^* \cdot \left( 1 + 3 \cdot \alpha \right)} \;, &amp; \Gamma^* \cdot \left( 1 + 3 \cdot \alpha \right) &lt; C
  \end{cases} \tag{4.5}
\end{equation}\]</span>
With this modification, <span class="math inline">\(W_p\)</span> is never negative, and it can never be the
smallest of <span class="math inline">\(W_c\)</span>, <span class="math inline">\(W_j\)</span>, and <span class="math inline">\(W_p\)</span> when
<span class="math inline">\(C \leq \Gamma^* \cdot \left( 1 + 3 \cdot \alpha \right)\)</span>, so we can safely use
it in conjunction with Equation <a href="#eq:mincjp">(4.4)</a>.</p>
<p>When carboxylation is TPU-limited, the corresponding net CO<sub>2</sub> assimilation
rate (called <span class="math inline">\(A_p\)</span> rather than <span class="math inline">\(A_n\)</span> to indicate the type of limitation) can be
found by combining Equations <a href="#eq:anfinal">(2.5)</a> and <a href="#eq:wp">(4.3)</a> as follows:
<span class="math display" id="eq:ap">\[\begin{equation}
A_p = W_p \cdot (1 - \Gamma^* / C) - R_d = \frac{3 \cdot T_p \cdot \left( C - \Gamma^* \right)}{C - \Gamma^* \cdot \left( 1 + 3 \cdot \alpha \right)} - R_d. \tag{4.6}
\end{equation}\]</span>
This equation is often incorporated into the pseudo-FvCB model discussed in
Section <a href="#sec:pitfallassim">3.2</a>; in this case, Equation <a href="#eq:analt">(3.7)</a> is
updated to the following:
<span class="math display" id="eq:analtnew">\[\begin{equation}
A_n = \min \{ A_c, A_j, A_p \}. \tag{4.7}
\end{equation}\]</span>
See, for example, Equations 2.26 and 2.27 in <span class="citation">von Caemmerer (<a href="#ref-caemmerer_biochemical_2000" role="doc-biblioref">2000</a>)</span>
(but be aware that Equation 2.26 has a typo in the denominator). Using Equation
<a href="#eq:analtnew">(4.7)</a> without considering the domain over which Equation
<a href="#eq:ap">(4.6)</a> is valid can cause some additional issues beyond the ones discussed
in Section <a href="#sec:pitfallassim">3.2</a>; in particular, the net assimilation rate may
become TPU-limited when <span class="math inline">\(C &lt; \Gamma^* \cdot \left( 1 + 3 \cdot \alpha \right)\)</span>,
although this should not be possible. This is just one more reason to choose a
minimal carboxylation rate (Equation <a href="#eq:mincjp">(4.4)</a>) rather than a minimal net
assimilation rate (Equation <a href="#eq:analtnew">(4.7)</a>) when using or describing the
FvCB model. Examples comparing the FvCB model against the pseudo-FvCB model can
be found in Section <a href="#sec:examples">6</a>.</p>
</div>
</div>
<div class="section level2" number="5">
<h2 id="handling-c-0">
<span class="header-section-number">5</span> Handling <em>C = 0</em><a class="anchor" aria-label="anchor" href="#handling-c-0"></a>
</h2>
<p>One issue with Equation <a href="#eq:anfinal">(2.5)</a> is that its value becomes undefined
when <span class="math inline">\(C = 0\)</span>. This is not a significant issue because <span class="math inline">\(C &gt; 0\)</span> in any realistic
situation. However, it is possible to extend the model to <span class="math inline">\(C = 0\)</span> by considering
the limiting value as <span class="math inline">\(C\)</span> approaches 0 from the right.</p>
<p>First, because carboxylation cannot be TPU-limited when
<span class="math inline">\(C \leq \Gamma^* \cdot \left( 1 + 3 \cdot \alpha \right)\)</span>, it cannot be TPU-limited
when <span class="math inline">\(C = 0\)</span>, and there is no need to consider it here. Next, note that although
<span class="math inline">\(1 - \Gamma^* / C\)</span> is undefined when <span class="math inline">\(C = 0\)</span>, <span class="math inline">\(A_c\)</span> and <span class="math inline">\(A_j\)</span> (Equations
<a href="#eq:ac">(3.5)</a> and <a href="#eq:aj">(3.6)</a>) are not. In fact, we have the following when
<span class="math inline">\(C = 0\)</span>:
<span class="math display">\[\begin{equation}
A_c \big|_{C = 0} = - \frac{\Gamma^* \cdot V_{cmax}}{K_c \cdot \left( 1 + O / K_o\right)} - R_d
\end{equation}\]</span>
and
<span class="math display">\[\begin{equation}
A_j \big|_{C = 0} = - \frac{J}{8} - R_d.
\end{equation}\]</span>
Remembering that Equation <a href="#eq:analt">(3.7)</a> <em>always</em> makes the wrong choice for
<span class="math inline">\(C &lt; \Gamma^*\)</span>, we can reverse its behavior to find <span class="math inline">\(A_n\)</span> when <span class="math inline">\(C = 0\)</span>:
<span class="math display">\[\begin{equation}
A_n \big|_{C = 0} = \max \bigl\{ A_c \big|_{C = 0}, A_j \big|_{C = 0} \bigr\}.
\end{equation}\]</span></p>
</div>
<div class="section level2" number="6">
<h2 id="sec:examples">
<span class="header-section-number">6</span> Examples Comparing the FvCB and Pseudo-FvCB Models<a class="anchor" aria-label="anchor" href="#sec:examples"></a>
</h2>
<p>Here we will use R to demonstrate some of the differences between the FvCB model
and the pseudo-FcVB model. First, we will define a function that implements the
FvCB model:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fvcb_model</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>  <span class="va">C</span>,     <span class="co"># microbar</span></span>
<span>  <span class="va">Vcmax</span>, <span class="co"># micromol / m^2 / s</span></span>
<span>  <span class="va">Kc</span>,    <span class="co"># microbar</span></span>
<span>  <span class="va">O</span>,     <span class="co"># mbar</span></span>
<span>  <span class="va">Ko</span>,    <span class="co"># mbar</span></span>
<span>  <span class="va">J</span>,     <span class="co"># micromol / m^2 / s</span></span>
<span>  <span class="va">Gstar</span>, <span class="co"># microbar</span></span>
<span>  <span class="va">Tp</span>,    <span class="co"># micromol / m^2 / s</span></span>
<span>  <span class="va">alpha</span>, <span class="co"># dimensionless</span></span>
<span>  <span class="va">Rd</span>     <span class="co"># micromol / m^2 / s</span></span>
<span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">Wc</span> <span class="op">&lt;-</span> <span class="va">Vcmax</span> <span class="op">*</span> <span class="va">C</span> <span class="op">/</span> <span class="op">(</span><span class="va">C</span> <span class="op">+</span> <span class="va">Kc</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">O</span> <span class="op">/</span> <span class="va">Ko</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">Wj</span> <span class="op">&lt;-</span> <span class="va">J</span> <span class="op">*</span> <span class="va">C</span> <span class="op">/</span> <span class="op">(</span><span class="fl">4</span> <span class="op">*</span> <span class="va">C</span> <span class="op">+</span> <span class="fl">8</span> <span class="op">*</span> <span class="va">Gstar</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">Wp</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">Tp</span> <span class="op">*</span> <span class="va">C</span> <span class="op">/</span> <span class="op">(</span><span class="va">C</span> <span class="op">-</span> <span class="va">Gstar</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">alpha</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">Wp</span><span class="op">[</span><span class="va">C</span> <span class="op">&lt;=</span> <span class="va">Gstar</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">alpha</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">Inf</span></span>
<span></span>
<span>  <span class="va">Vc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">Wc</span>, <span class="va">Wj</span>, <span class="va">Wp</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">An</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">Gstar</span> <span class="op">/</span> <span class="va">C</span><span class="op">)</span> <span class="op">*</span> <span class="va">Vc</span> <span class="op">-</span> <span class="va">Rd</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Wc <span class="op">=</span> <span class="va">Wc</span>, Wj <span class="op">=</span> <span class="va">Wj</span>, Wp <span class="op">=</span> <span class="va">Wp</span>, Vc <span class="op">=</span> <span class="va">Vc</span>, An <span class="op">=</span> <span class="va">An</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Now, we will define a function that implements the pseudo-FvCB model; here we
will intentionally avoid restricting <span class="math inline">\(A_p\)</span> to its proper <span class="math inline">\(C\)</span> domain, allowing it
to become limiting at low <span class="math inline">\(C\)</span>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pseudo_fvcb_model</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>  <span class="va">C</span>,     <span class="co"># microbar</span></span>
<span>  <span class="va">Vcmax</span>, <span class="co"># micromol / m^2 / s</span></span>
<span>  <span class="va">Kc</span>,    <span class="co"># microbar</span></span>
<span>  <span class="va">O</span>,     <span class="co"># mbar</span></span>
<span>  <span class="va">Ko</span>,    <span class="co"># mbar</span></span>
<span>  <span class="va">J</span>,     <span class="co"># micromol / m^2 / s</span></span>
<span>  <span class="va">Gstar</span>, <span class="co"># microbar</span></span>
<span>  <span class="va">Tp</span>,    <span class="co"># micromol / m^2 / s</span></span>
<span>  <span class="va">alpha</span>, <span class="co"># dimensionless</span></span>
<span>  <span class="va">Rd</span>     <span class="co"># micromol / m^2 / s</span></span>
<span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">Ac</span> <span class="op">&lt;-</span> <span class="va">Vcmax</span> <span class="op">*</span> <span class="op">(</span><span class="va">C</span> <span class="op">-</span> <span class="va">Gstar</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">C</span> <span class="op">+</span> <span class="va">Kc</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">O</span> <span class="op">/</span> <span class="va">Ko</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="va">Rd</span></span>
<span></span>
<span>  <span class="va">Aj</span> <span class="op">&lt;-</span> <span class="va">J</span> <span class="op">*</span> <span class="op">(</span><span class="va">C</span> <span class="op">-</span> <span class="va">Gstar</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">4</span> <span class="op">*</span> <span class="va">C</span> <span class="op">+</span> <span class="fl">8</span> <span class="op">*</span> <span class="va">Gstar</span><span class="op">)</span> <span class="op">-</span> <span class="va">Rd</span></span>
<span></span>
<span>  <span class="va">Ap</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">Tp</span> <span class="op">*</span> <span class="op">(</span><span class="va">C</span> <span class="op">-</span> <span class="va">Gstar</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">C</span> <span class="op">-</span> <span class="va">Gstar</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">alpha</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="va">Rd</span></span>
<span></span>
<span>  <span class="va">An</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">Ac</span>, <span class="va">Aj</span>, <span class="va">Ap</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Ac <span class="op">=</span> <span class="va">Ac</span>, Aj <span class="op">=</span> <span class="va">Aj</span>, Ap <span class="op">=</span> <span class="va">Ap</span>, An <span class="op">=</span> <span class="va">An</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We will also define a function that runs each model across a range of <span class="math inline">\(C\)</span> values
for a set of input parameter values and compares the results by creating
figures. The code for this function is not included in this article, but can be
found in its source file. It will be used to generate the figures in the
following sections.</p>
<p>Finally, we will also define some default parameter values to use for our
simulations; these correspond to bright conditions with <span class="math inline">\(\alpha = 0\)</span>. All values
are from the caption of Figure 2.6 in <span class="citation">von Caemmerer (<a href="#ref-caemmerer_biochemical_2000" role="doc-biblioref">2000</a>)</span> with the
exception of <span class="math inline">\(O\)</span>, which was not specified in the caption. The value for <span class="math inline">\(O\)</span>
chosen here is approximately the atmospheric partial pressure of O<sub>2</sub>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">defaults</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  Vcmax <span class="op">=</span> <span class="fl">100</span>,  <span class="co"># micromol / m^2 / s</span></span>
<span>  Kc <span class="op">=</span> <span class="fl">259</span>,     <span class="co"># microbar</span></span>
<span>  O <span class="op">=</span> <span class="fl">200</span>,      <span class="co"># mbar</span></span>
<span>  Ko <span class="op">=</span> <span class="fl">179</span>,     <span class="co"># mbar</span></span>
<span>  J <span class="op">=</span> <span class="fl">170</span>,      <span class="co"># micromol / m^2 / s</span></span>
<span>  Gstar <span class="op">=</span> <span class="fl">38.6</span>, <span class="co"># microbar</span></span>
<span>  Tp <span class="op">=</span> <span class="fl">11.8</span>,    <span class="co"># micromol / m^2 / s</span></span>
<span>  alpha <span class="op">=</span> <span class="fl">0</span>,    <span class="co"># dimensionless</span></span>
<span>  Rd <span class="op">=</span> <span class="fl">1</span>        <span class="co"># micromol / m^2 / s</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Each of the following sections will include three separate figures representing
the model outputs at a certain set of conditions:</p>
<ol style="list-style-type: decimal">
<li><p>A figure showing <span class="math inline">\(W_c\)</span>, <span class="math inline">\(W_j\)</span>, <span class="math inline">\(W_p\)</span>, <span class="math inline">\(V_c\)</span>, and <span class="math inline">\(A_n\)</span> (calculated using
Equations <a href="#eq:anfinal">(2.5)</a> and <a href="#eq:mincjp">(4.4)</a>). This figure shows how the
net CO<sub>2</sub> assimilation rate is determined in the FvCB model.</p></li>
<li><p>A figure showing <span class="math inline">\(A_c\)</span>, <span class="math inline">\(A_j\)</span>, <span class="math inline">\(A_p\)</span> and <span class="math inline">\(A_n\)</span> (calculated using Equation
<a href="#eq:analtnew">(4.7)</a>). This figure shows how the net CO<sub>2</sub> assimilation rate is
determined in the pseudo-FvCB model.</p></li>
<li><p>A figure showing <span class="math inline">\(A_n\)</span> as calculated by the two different models,
highlighting the differences between them.</p></li>
</ol>
<div class="section level3" number="6.1">
<h3 id="bright-conditions-alpha-0">
<span class="header-section-number">6.1</span> Bright Conditions, <span class="math inline">\(\alpha = 0\)</span><a class="anchor" aria-label="anchor" href="#bright-conditions-alpha-0"></a>
</h3>
<p>In this case, the only difference between the models occurs for <span class="math inline">\(C &lt; \Gamma^*\)</span>,
where carboxylation is RuBP-saturated in the FvCB model but assimilation is
RuBP-regeneration-limited in the pseudo-FvCB model.</p>
<p><img src="avoiding_pitfalls_fvcb_files/figure-html/unnamed-chunk-6-1.png" style="display: block; margin: auto;"></p>
<p><img src="avoiding_pitfalls_fvcb_files/figure-html/unnamed-chunk-7-1.png" style="display: block; margin: auto;"></p>
<p><img src="avoiding_pitfalls_fvcb_files/figure-html/unnamed-chunk-8-1.png" style="display: block; margin: auto;"></p>
</div>
<div class="section level3" number="6.2">
<h3 id="bright-conditions-alpha-0-5">
<span class="header-section-number">6.2</span> Bright Conditions, <span class="math inline">\(\alpha = 0.5\)</span><a class="anchor" aria-label="anchor" href="#bright-conditions-alpha-0-5"></a>
</h3>
<p>Here we set <span class="math inline">\(\alpha\)</span> to 0.5 and reduce <span class="math inline">\(T_p\)</span> to 10 (to make TPU limitations
easier to spot.) As before, there is a difference between the models when
<span class="math inline">\(C &lt; \Gamma^*\)</span>, where carboxylation is RuBP-saturated in the FvCB model but
assimilation is RuBP-regeneration-limited in the pseudo-FvCB model. There is
also another difference because <span class="math inline">\(Ap\)</span> becomes negative for
<span class="math inline">\(C &lt; \Gamma^* \cdot \left(1 + 3 \cdot \alpha \right)\)</span>, leading to an unrealistic
and sudden dip in net assimilation in the pseudo-FvCB model near <span class="math inline">\(C\)</span> = 100
<span class="math inline">\(\mu\)</span>bar.</p>
<p><img src="avoiding_pitfalls_fvcb_files/figure-html/unnamed-chunk-9-1.png" style="display: block; margin: auto;"></p>
<p><img src="avoiding_pitfalls_fvcb_files/figure-html/unnamed-chunk-10-1.png" style="display: block; margin: auto;"></p>
<p><img src="avoiding_pitfalls_fvcb_files/figure-html/unnamed-chunk-11-1.png" style="display: block; margin: auto;"></p>
</div>
<div class="section level3" number="6.3">
<h3 id="dim-conditions-alpha-0">
<span class="header-section-number">6.3</span> Dim Conditions, <span class="math inline">\(\alpha = 0\)</span><a class="anchor" aria-label="anchor" href="#dim-conditions-alpha-0"></a>
</h3>
<p>Here we set <span class="math inline">\(J\)</span> to 10, simulating dim light. Again, there is a difference
between the models for <span class="math inline">\(C &lt; \Gamma^*\)</span>, but now the opposite scenario occurs with
respect to the bright conditions: carboxylation is RuBP-regeneration-limited in
the FvCB model but assimilation is RuBP-saturated in the pseudo-FvCB model.</p>
<p><img src="avoiding_pitfalls_fvcb_files/figure-html/unnamed-chunk-12-1.png" style="display: block; margin: auto;"></p>
<p><img src="avoiding_pitfalls_fvcb_files/figure-html/unnamed-chunk-13-1.png" style="display: block; margin: auto;"></p>
<p><img src="avoiding_pitfalls_fvcb_files/figure-html/unnamed-chunk-14-1.png" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2" number="7">
<h2 id="final-remarks">
<span class="header-section-number">7</span> Final Remarks<a class="anchor" aria-label="anchor" href="#final-remarks"></a>
</h2>
<p>In this document, we have shown that although the pseudo-FvCB model equations
are frequently used by plant biologists, they are not exactly equivalent to the
original FvCB model. Differences occur at low CO<sub>2</sub> concentrations where
<span class="math inline">\(C &lt; \Gamma^*\)</span>; in this situation, the two models always disagree as to which
process limits carboxylation and determines the overall net CO<sub>2</sub> assimilation
rate. While these differences may not always be consequential (for example,
CO<sub>2</sub> concentrations are rarely low enough in the context of a typical crop
growth simulation), it is nevertheless important to ensure that any mathematical
model is described accurately, and that any code implementation of a model
faithfully represents it. If this is not the case, then evaluating the ability
of a model to represent reality—an essential goal of computational
modeling—becomes an impossible task. For this reason, we recommend that the
original formulation of the model be preferred to the pseudo-FvCB version when
using the FvCB model.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-collatz_physiological_1991" class="csl-entry">
Collatz, G. James, J. Timothy Ball, Cyril Grivet, and Joseph A Berry. 1991. <span>“Physiological and Environmental Regulation of Stomatal Conductance, Photosynthesis and Transpiration: A Model That Includes a Laminar Boundary Layer.”</span> <em>Agricultural and Forest Meteorology</em> 54 (2): 107–36. <a href="https://doi.org/10.1016/0168-1923(91)90002-8" class="external-link">https://doi.org/10.1016/0168-1923(91)90002-8</a>.
</div>
<div id="ref-farquhar_modelling_1982" class="csl-entry">
Farquhar, G. D., and S. von Caemmerer. 1982. <span>“Modelling of <span>Photosynthetic</span> <span>Response</span> to <span>Environmental</span> <span>Conditions</span>.”</span> In <em>Physiological <span>Plant</span> <span>Ecology</span> <span>II</span>: <span>Water</span> <span>Relations</span> and <span>Carbon</span> <span>Assimilation</span></em>, edited by O. L. Lange, P. S. Nobel, C. B. Osmond, and H. Ziegler, 549–87. Encyclopedia of <span>Plant</span> <span>Physiology</span>. Berlin, Heidelberg: Springer. <a href="https://doi.org/10.1007/978-3-642-68150-9_17" class="external-link">https://doi.org/10.1007/978-3-642-68150-9_17</a>.
</div>
<div id="ref-farquhar_biochemical_1980" class="csl-entry">
Farquhar, G. D., S. von Caemmerer, and J. A. Berry. 1980. <span>“A Biochemical Model of Photosynthetic <span>CO2</span> Assimilation in Leaves of <span>C3</span> Species.”</span> <em>Planta</em> 149 (1): 78–90. <a href="https://doi.org/10.1007/BF00386231" class="external-link">https://doi.org/10.1007/BF00386231</a>.
</div>
<div id="ref-harley_improved_1991" class="csl-entry">
Harley, Peter C., and Thomas D. Sharkey. 1991. <span>“An Improved Model of <span>C3</span> Photosynthesis at High <span>CO2</span>: <span>Reversed</span> <span>O2</span> Sensitivity Explained by Lack of Glycerate Reentry into the Chloroplast.”</span> <em>Photosynthesis Research</em> 27 (3): 169–78. <a href="https://doi.org/10.1007/BF00035838" class="external-link">https://doi.org/10.1007/BF00035838</a>.
</div>
<div id="ref-kirschbaum_temperature_1984" class="csl-entry">
Kirschbaum, M. U. F., and G. D. Farquhar. 1984. <span>“Temperature <span>Dependence</span> of <span>Whole</span>-<span>Leaf</span> <span>Photosynthesis</span> in <span>Eucalyptus</span> Pauciflora <span>Sieb</span>. <span>Ex</span> <span>Spreng</span>.”</span> <em>Australian Journal of Plant Physiology</em> 11 (6): 519–38. <a href="https://doi.org/10.1071/pp9840519" class="external-link">https://doi.org/10.1071/pp9840519</a>.
</div>
<div id="ref-sharkey_photosynthesis_1985" class="csl-entry">
Sharkey, Thomas D. 1985. <span>“Photosynthesis in Intact Leaves of <span>C3</span> Plants: <span>Physics</span>, Physiology and Rate Limitations.”</span> <em>The Botanical Review</em> 51 (1): 53–105. <a href="https://doi.org/10.1007/BF02861058" class="external-link">https://doi.org/10.1007/BF02861058</a>.
</div>
<div id="ref-sharkey_fitting_2007" class="csl-entry">
Sharkey, Thomas D., Carl J. Bernacchi, Graham D. Farquhar, and Eric L. Singsaas. 2007. <span>“Fitting Photosynthetic Carbon Dioxide Response Curves for <span>C3</span> Leaves.”</span> <em>Plant, Cell &amp; Environment</em> 30 (9): 1035–40. <a href="https://doi.org/10.1111/j.1365-3040.2007.01710.x" class="external-link">https://doi.org/10.1111/j.1365-3040.2007.01710.x</a>.
</div>
<div id="ref-caemmerer_biochemical_2000" class="csl-entry">
von Caemmerer, S. 2000. <em>Biochemical <span>Models</span> of <span>Leaf</span> <span>Photosynthesis</span></em>. CSIRO Publishing. <a href="https://doi.org/10.1071/9780643103405" class="external-link">https://doi.org/10.1071/9780643103405</a>.
</div>
<div id="ref-von_caemmerer_steady-state_2013" class="csl-entry">
von Caemmerer, S. 2013. <span>“Steady-State Models of Photosynthesis.”</span> <em>Plant, Cell &amp; Environment</em> 36 (9): 1617–30. <a href="https://doi.org/10.1111/pce.12098" class="external-link">https://doi.org/10.1111/pce.12098</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Justin M. McGrath, Edward B. Lochocki, Scott Rohde, Deepak Jaiswal, Megan L. Matthews, Fernando E. Miguez, Stephen P. Long.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
