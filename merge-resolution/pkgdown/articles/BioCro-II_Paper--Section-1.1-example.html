<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="BioCro">
<title>BioCro II Paper: Section 1.1 Example • BioCro</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="BioCro II Paper: Section 1.1 Example">
<meta property="og:description" content="BioCro">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BioCro</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../about_pkgdown_documentation.html">About</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>GENERAL BIOCRO USAGE</h6>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/a_practical_guide_to_biocro.pdf">A Practical Guide to BioCro (PDF)</a>
    <a class="dropdown-item" href="../articles/a_practical_guide_to_biocro.R">    [R code]</a>
    <a class="dropdown-item" href="../articles/quantitative_model_comparison.pdf">Quantitative Comparison Between Two Photosynthesis Models (PDF)</a>
    <a class="dropdown-item" href="../articles/quantitative_model_comparison.R">    [R code]</a>
    <a class="dropdown-item" href="../articles/BioCro-II_Paper--Section-1.1-example.html">BioCro II Paper: Section 1.1 Example (HTML)</a>
    <a class="dropdown-item" href="../articles/dynamical_systems.pdf">BioCro as a Dynamical System</a>
    <a class="dropdown-item" href="../articles/an_introduction_to_biocro.pdf">An Introduction to BioCro for Those Who Want to Add Models (PDF)</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>CROP GROWTH MODELING TOPICS</h6>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/avoiding_pitfalls_fvcb.html">Avoiding Pitfalls When Using the FvCB Model (HTML)</a>
    <a class="dropdown-item" href="../articles/thick_layer_absorption.html">Light Absorption by a Thick Layer (HTML)</a>
    <a class="dropdown-item" href="../articles/ball_berry_model.html">Using the Ball-Berry Model (HTML)</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../bookdown/index.html">Developer's Manual</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-c-library">C++ Library</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-c-library">
    <a class="dropdown-item" href="../../doxygen/doxygen_docs_complete/index.html">Complete Doxygen Documentation</a>
    <a class="dropdown-item" href="../../doxygen/doxygen_docs_framework/index.html">Framework Documentation</a>
    <a class="dropdown-item" href="../../doxygen/doxygen_docs_modules/index.html">BioCro Module Documentation</a>
    <a class="dropdown-item" href="../../doxygen/doxygen_docs_modules_public_members_only/index.html">BioCro Module Documentation (public members only)</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ebimodeling/biocro/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>BioCro II Paper: Section 1.1 Example</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ebimodeling/biocro/blob/HEAD/vignettes/BioCro-II_Paper--Section-1.1-example.Rmd" class="external-link"><code>vignettes/BioCro-II_Paper--Section-1.1-example.Rmd</code></a></small>
      <div class="d-none name"><code>BioCro-II_Paper--Section-1.1-example.Rmd</code></div>
    </div>

    
    
<!-- Note that we start with a level-2 heading so that, following best
practices, the document title is the one and only h1 element in the
document. -->
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This is a demonstration of the example discussed in Section 1.1 and
Appendix 1 of the BioCro II paper <span class="citation">(Lochocki et
al. 2022)</span>. A few corrections to and clarifications of the
exposition given in that paper are given in the comments below.</p>
</div>
<div class="section level2">
<h2 id="the-code">The Code<a class="anchor" aria-label="anchor" href="#the-code"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ebimodeling/biocro" class="external-link">BioCro</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lattice.r-forge.r-project.org/" class="external-link">lattice</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span> <span class="co"># for kable(), which yields nicer-looking tables</span></span>
<span></span>
<span><span class="co">## customized version of kable with defined options:</span></span>
<span><span class="va">columns_to_print</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'time'</span>, <span class="st">'Q'</span>, <span class="st">'mass_gain'</span>, <span class="st">'Root'</span>, <span class="st">'Leaf'</span><span class="op">)</span></span>
<span><span class="va">show_row_number</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">format</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>scientific <span class="op">=</span> <span class="cn">FALSE</span>, digits <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">cable</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>, <span class="va">columns_to_print</span><span class="op">]</span>,</span>
<span>         row.names <span class="op">=</span> <span class="va">show_row_number</span>,</span>
<span>         format.args <span class="op">=</span> <span class="va">format</span>,</span>
<span>         <span class="va">...</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## Set plotting character globally</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/trellis.par.get.html" class="external-link">trellis.par.set</a></span><span class="op">(</span><span class="st">"plot.symbol"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pch <span class="op">=</span> <span class="st">'.'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">################################################################################</span></span>
<span></span>
<span><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    alpha_rue <span class="op">=</span> <span class="fl">0.07</span>, <span class="co"># kg / mol</span></span>
<span>    SLA <span class="op">=</span> <span class="fl">25</span>,         <span class="co"># m^2 / kg</span></span>
<span>    C_conv <span class="op">=</span> <span class="fl">0.03</span>,    <span class="co"># kg / mol</span></span>
<span>    f_leaf <span class="op">=</span> <span class="fl">0.2</span>,     <span class="co"># kg / kg</span></span>
<span>    f_root <span class="op">=</span> <span class="fl">0.8</span>,     <span class="co"># kg / kg</span></span>
<span>    timestep <span class="op">=</span> <span class="fl">1</span>      <span class="co"># s</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">initial_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    Leaf <span class="op">=</span> <span class="fl">1</span>, <span class="co"># kg</span></span>
<span>    Root <span class="op">=</span> <span class="fl">1</span>  <span class="co"># kg</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">time</span><span class="op">/</span><span class="fl">3600</span><span class="op">/</span><span class="fl">12</span> <span class="op">*</span> <span class="va">pi</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2000e-6</span> <span class="co"># mol / m^2 / s</span></span>
<span></span>
<span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="fl">3600</span> <span class="op">*</span> <span class="fl">12</span><span class="op">)</span> <span class="co"># seconds</span></span>
<span></span>
<span><span class="va">light_intensity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    time <span class="op">=</span> <span class="va">times</span>,</span>
<span>    Q <span class="op">=</span> <span class="fu">Q</span><span class="op">(</span><span class="va">times</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_biocro.html">run_biocro</a></span><span class="op">(</span></span>
<span>    <span class="va">initial_values</span>,</span>
<span>    <span class="va">parameters</span>,</span>
<span>    <span class="va">light_intensity</span>,</span>
<span>    <span class="st">'BioCro:example_model_mass_gain'</span>,</span>
<span>    <span class="st">'BioCro:example_model_partitioning'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">Q</span> <span class="op">~</span> <span class="va">time</span>, data <span class="op">=</span> <span class="va">result</span>, xlab <span class="op">=</span> <span class="st">"time (s)"</span>, ylab <span class="op">=</span> <span class="st">"Q (mol / m^2 / s)"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">Leaf</span> <span class="op">~</span> <span class="va">time</span>, data <span class="op">=</span> <span class="va">result</span>, xlab <span class="op">=</span> <span class="st">"time (s)"</span>, ylab <span class="op">=</span> <span class="st">"Leaf (kg)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="BioCro-II_Paper--Section-1.1-example_files/figure-html/original-example-1.png" width="50%"><img src="BioCro-II_Paper--Section-1.1-example_files/figure-html/original-example-2.png" width="50%"></p>
<div class="section level3">
<h3 id="a-few-comments">A few comments<a class="anchor" aria-label="anchor" href="#a-few-comments"></a>
</h3>
<div class="section level4">
<h4 id="the-formula-for-the-driver">The formula for the driver<a class="anchor" aria-label="anchor" href="#the-formula-for-the-driver"></a>
</h4>
<p>A somewhat plausible mechanistic model of the photosynthetic photon
flux density Q due to the sun would give it as being roughly
proportional to the sine of the angle the sun makes with the horizon.
Assuming 12 hours of daylight, with the sun passing directly overhead (a
condition that approximately holds at the equator during an equinox),
this angle (measured in radians) is approximately
<code>time/3600/12 * pi</code>, where <code>time</code> is the number of
seconds that have elapsed since sunrise. (Here, an angle greater than
<code>pi/2</code> is taken to be the angle of the position of the sun
measured from its position at sunrise; this value thus takes a maximum
value of <code>pi</code> at sunset.) Assuming a maxumum flux density of
<code>2000e-6 mol / m^2 /s</code> (attained at solar noon when the sine
is 1) then yields the function given for <code>Q</code>.</p>
<p>Note that instead of supplying <code>Q</code> as a driver, we could
have instead written a direct module that computed Q from the time of
day. The latter would then be, for this example, the only driver.</p>
</div>
<div class="section level4">
<h4 id="the-timestep-parameter">The <code>timestep</code> parameter<a class="anchor" aria-label="anchor" href="#the-timestep-parameter"></a>
</h4>
<p>Note that the timestep value given in the parameters is in seconds.
<strong>But also note that almost all differential modules in the BioCro
library assume that timestep values are given in hours!</strong></p>
<p>If a timestep value is given in seconds rather than in hours, three
important things must be kept in mind:</p>
<ol style="list-style-type: decimal">
<li><p><em>All</em> differential modules used in the simulation must
assume that the timestep value is given in seconds. Another way of
saying this is that the outputs of the differential modules used should
represent the rate of change of the output quantities <em>per
second</em>.</p></li>
<li><p>In almost all cases, the output columns “doy”, “hour”, and
possibly “time” won’t make sense and (if not filtered out) should be
ignored.</p></li>
<li><p>In almost all cases, no module having <code>time</code> as input
should be used. (See below for further discussion.)</p></li>
</ol>
<p>The same precepts apply, <em>mutatis mutandi</em>, to any other
timestep units one may wish to use.</p>
<p>As always, the difference in time between any row <em>n</em> in the
<em>drivers</em> dataframe and the row <em>n + 1</em> that immediately
follows it should be equal to “timestep” (in whatever units
<em>timestep</em> has been given).</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="first-modification-24-hour-simulation">First modification: 24 hour simulation<a class="anchor" aria-label="anchor" href="#first-modification-24-hour-simulation"></a>
</h2>
<p>Although in the paper it is stated that “Light intensity is given as
a table of values at every second in a 24-h period,”, the period here is
actually only 12 hours (time ranges from 0 to 3600 × 12 seconds = 12
hours). As noted above, for the purposes of this example, it may be
assumed that time ranges from sunrise to sunset of a 12-hour day so that
“time” represents the number of seconds that have elapsed since
sunrise.</p>
<p>Alternatively, we could have assumed time to range over a 24-hour
period starting and ending at solar midnight, with Q being zero before
sunrise and after sunset. This entails a slight modification to the
defining equations:</p>
<pre><code><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="fl">3600</span> <span class="op">*</span> <span class="fl">24</span><span class="op">)</span> <span class="co"># seconds</span></span>
<span></span>
<span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="op">(</span><span class="va">time</span><span class="op">/</span><span class="fl">3600</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">/</span><span class="fl">12</span> <span class="op">*</span> <span class="va">pi</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2000e-6</span><span class="op">)</span> <span class="co"># mol / m^2 / s</span></span></code></pre>
<p>(The “− 6” here adjusts the phase of the sine function so that the
positive values correspond to the daylight hours, assumed to begin at 6
a.m. solar time.)</p>
<p>Here is how the 24-hour version of the example would look. A few rows
of the result table are printed at significant portions of the day: at
the beginning, just after midnight, when it is dark and there is no mass
accumulation; at dawn, when the rate of mass accumulation first becomes
non-zero; at noon, when the flux Q is highest; at dusk, when the rate of
mass accumulation again drops to zero; and at the end of the simulation,
when the final leaf and root mass are known.</p>
<p>As noted above, the values in the result for <code>doy</code> and
<code>hour</code> are nonsensical in the context of this example and so
we have filtered them out (along with <code>ncalls</code>, which is not
of particular interest). And the values in the <code>time</code> column
should be interpreted as the number of elapsed seconds from solar
midnight (not the number of (fractional) days that have elapsed since
midnight at the start of December 31, which is the correct
interpretation in a “normal” BioCro simulation).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="fl">3600</span> <span class="op">*</span> <span class="fl">24</span><span class="op">)</span> <span class="co"># seconds</span></span>
<span></span>
<span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="op">(</span><span class="va">time</span><span class="op">/</span><span class="fl">3600</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">/</span><span class="fl">12</span> <span class="op">*</span> <span class="va">pi</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2000e-6</span><span class="op">)</span> <span class="co"># mol / m^2 / s</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">light_intensity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    time <span class="op">=</span> <span class="va">times</span>,</span>
<span>    Q <span class="op">=</span> <span class="fu">Q</span><span class="op">(</span><span class="va">times</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_biocro.html">run_biocro</a></span><span class="op">(</span></span>
<span>    <span class="va">initial_values</span>,</span>
<span>    <span class="va">parameters</span>,</span>
<span>    <span class="va">light_intensity</span>,</span>
<span>    <span class="st">'BioCro:example_model_mass_gain'</span>,</span>
<span>    <span class="st">'BioCro:example_model_partitioning'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## cable = customized version of kable (see above)</span></span>
<span><span class="co">## kable = (nicely-formatted) knitr table</span></span>
<span><span class="fu">cable</span><span class="op">(</span><span class="va">result</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="op">]</span><span class="op">)</span> <span class="co"># beginning</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">time</th>
<th align="right">Q</th>
<th align="right">mass_gain</th>
<th align="right">Root</th>
<th align="right">Leaf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cable</span><span class="op">(</span><span class="va">result</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">21591</span>, <span class="fl">21661</span>, <span class="fl">10</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span> <span class="co"># around dawn</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">time</th>
<th align="right">Q</th>
<th align="right">mass_gain</th>
<th align="right">Root</th>
<th align="right">Leaf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">21590</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">1.000000</td>
<td align="right">1.000000</td>
</tr>
<tr class="even">
<td align="right">21600</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">1.000000</td>
<td align="right">1.000000</td>
</tr>
<tr class="odd">
<td align="right">21610</td>
<td align="right">0.0000015</td>
<td align="right">0.0000001</td>
<td align="right">1.000000</td>
<td align="right">1.000000</td>
</tr>
<tr class="even">
<td align="right">21620</td>
<td align="right">0.0000029</td>
<td align="right">0.0000002</td>
<td align="right">1.000001</td>
<td align="right">1.000000</td>
</tr>
<tr class="odd">
<td align="right">21630</td>
<td align="right">0.0000044</td>
<td align="right">0.0000002</td>
<td align="right">1.000003</td>
<td align="right">1.000001</td>
</tr>
<tr class="even">
<td align="right">21640</td>
<td align="right">0.0000058</td>
<td align="right">0.0000003</td>
<td align="right">1.000005</td>
<td align="right">1.000001</td>
</tr>
<tr class="odd">
<td align="right">21650</td>
<td align="right">0.0000073</td>
<td align="right">0.0000004</td>
<td align="right">1.000007</td>
<td align="right">1.000002</td>
</tr>
<tr class="even">
<td align="right">21660</td>
<td align="right">0.0000087</td>
<td align="right">0.0000005</td>
<td align="right">1.000011</td>
<td align="right">1.000003</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cable</span><span class="op">(</span><span class="va">result</span><span class="op">[</span><span class="fl">43199</span><span class="op">:</span><span class="fl">43203</span>,<span class="op">]</span><span class="op">)</span> <span class="co"># around mid day</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">time</th>
<th align="right">Q</th>
<th align="right">mass_gain</th>
<th align="right">Root</th>
<th align="right">Leaf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">43198</td>
<td align="right">0.002</td>
<td align="right">0.0001401</td>
<td align="right">2.338850</td>
<td align="right">1.334712</td>
</tr>
<tr class="even">
<td align="right">43199</td>
<td align="right">0.002</td>
<td align="right">0.0001401</td>
<td align="right">2.338962</td>
<td align="right">1.334740</td>
</tr>
<tr class="odd">
<td align="right">43200</td>
<td align="right">0.002</td>
<td align="right">0.0001402</td>
<td align="right">2.339074</td>
<td align="right">1.334769</td>
</tr>
<tr class="even">
<td align="right">43201</td>
<td align="right">0.002</td>
<td align="right">0.0001402</td>
<td align="right">2.339186</td>
<td align="right">1.334796</td>
</tr>
<tr class="odd">
<td align="right">43202</td>
<td align="right">0.002</td>
<td align="right">0.0001402</td>
<td align="right">2.339298</td>
<td align="right">1.334825</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cable</span><span class="op">(</span><span class="va">result</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">64741</span>, <span class="fl">64811</span>, <span class="fl">10</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span> <span class="co"># around dusk</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">time</th>
<th align="right">Q</th>
<th align="right">mass_gain</th>
<th align="right">Root</th>
<th align="right">Leaf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">64740</td>
<td align="right">0.0000087</td>
<td align="right">0.0000008</td>
<td align="right">4.126557</td>
<td align="right">1.781639</td>
</tr>
<tr class="even">
<td align="right">64750</td>
<td align="right">0.0000073</td>
<td align="right">0.0000007</td>
<td align="right">4.126563</td>
<td align="right">1.781641</td>
</tr>
<tr class="odd">
<td align="right">64760</td>
<td align="right">0.0000058</td>
<td align="right">0.0000005</td>
<td align="right">4.126568</td>
<td align="right">1.781642</td>
</tr>
<tr class="even">
<td align="right">64770</td>
<td align="right">0.0000044</td>
<td align="right">0.0000004</td>
<td align="right">4.126572</td>
<td align="right">1.781643</td>
</tr>
<tr class="odd">
<td align="right">64780</td>
<td align="right">0.0000029</td>
<td align="right">0.0000003</td>
<td align="right">4.126575</td>
<td align="right">1.781644</td>
</tr>
<tr class="even">
<td align="right">64790</td>
<td align="right">0.0000015</td>
<td align="right">0.0000001</td>
<td align="right">4.126576</td>
<td align="right">1.781644</td>
</tr>
<tr class="odd">
<td align="right">64800</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">4.126577</td>
<td align="right">1.781644</td>
</tr>
<tr class="even">
<td align="right">64810</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">4.126577</td>
<td align="right">1.781644</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cable</span><span class="op">(</span><span class="va">result</span><span class="op">[</span><span class="fl">86398</span><span class="op">:</span><span class="fl">86401</span>,<span class="op">]</span><span class="op">)</span> <span class="co"># end</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">time</th>
<th align="right">Q</th>
<th align="right">mass_gain</th>
<th align="right">Root</th>
<th align="right">Leaf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">86397</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4.126577</td>
<td align="right">1.781644</td>
</tr>
<tr class="even">
<td align="right">86398</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4.126577</td>
<td align="right">1.781644</td>
</tr>
<tr class="odd">
<td align="right">86399</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4.126577</td>
<td align="right">1.781644</td>
</tr>
<tr class="even">
<td align="right">86400</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4.126577</td>
<td align="right">1.781644</td>
</tr>
</tbody>
</table>
<p>In the following graphs, we have changed the labeling on the x axis
so that time is shown in hours rather than seconds.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">Q</span> <span class="op">~</span> <span class="va">time</span> <span class="op">/</span> <span class="fl">3600</span>, data <span class="op">=</span> <span class="va">result</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">24</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"time (in hours)"</span>, ylab <span class="op">=</span> <span class="st">"Q (mol / m^2 / s)"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">Leaf</span> <span class="op">~</span> <span class="va">time</span> <span class="op">/</span> <span class="fl">3600</span>, data <span class="op">=</span> <span class="va">result</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">24</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"time (in hours)"</span>, ylab <span class="op">=</span> <span class="st">"Leaf (kg)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="BioCro-II_Paper--Section-1.1-example_files/figure-html/plots-for-24-hour-version-1.png" width="50%"><img src="BioCro-II_Paper--Section-1.1-example_files/figure-html/plots-for-24-hour-version-2.png" width="50%"></p>
</div>
<div class="section level2">
<h2 id="second-modification-changing-the-time-specification-from-seconds-to-days">Second modification: Changing the time specification from seconds to
days<a class="anchor" aria-label="anchor" href="#second-modification-changing-the-time-specification-from-seconds-to-days"></a>
</h2>
<p>The usual assumption in BioCro is that the <code>time</code> quantity
represents the time, in days, from the beginning of the year, not the
number of seconds that have elapsed from the start of the simulation.
(More precisely, the integral part of the <code>time</code> value should
be the day of the year, counting from one, and the fractional part
should be the portion of the day that has elapsed since midnight at the
begining of that day. Thus <code>time = 4.25</code> would occur at 6
a.m. on January 4.)</p>
<p>It follows, then, that the way we have been using the
<code>time</code> variable in the previous examples in inconsistent with
the usual interpretation of time in two respects: First, the units were
in seconds rather than days. Second, the time represented the amount of
time elapsed from the beginning of the simulation rather than an
“absolute” time, that is, a time value specifying a specific time of day
on a specific day of the year. (There is no great harm in using the
<code>time</code> variable in this unconventional way of the previous
examples, as long as we know what we are doing and as long as we aren’t
using any modules that assume the <em>conventional</em> interpretation
of the <code>time</code> variable. In fact, in simulations such as these
ones, the result table is arguably more readable when we have our time
value in seconds or hours rather than in days.)</p>
<p>The first of these inconsistencies is easily remedied by rescaling
the time values so that instead of running from 0 to 86400 (seconds),
they run from from 0 to 1 (days): we simply divide each former time
value by 86400. Now, the value of <code>time</code> increases by 1/86400
(of a day!) from row to row (an amount still corresponding to one
second):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">light_intensity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    time <span class="op">=</span> <span class="va">times</span><span class="op">/</span><span class="fl">86400</span>,</span>
<span>    Q <span class="op">=</span> <span class="fu">Q</span><span class="op">(</span><span class="va">times</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_biocro.html">run_biocro</a></span><span class="op">(</span></span>
<span>    <span class="va">initial_values</span>,</span>
<span>    <span class="va">parameters</span>,</span>
<span>    <span class="va">light_intensity</span>,</span>
<span>    <span class="st">'BioCro:example_model_mass_gain'</span>,</span>
<span>    <span class="st">'BioCro:example_model_partitioning'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cable</span><span class="op">(</span><span class="va">result</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="op">]</span><span class="op">)</span> <span class="co"># beginning</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">time</th>
<th align="right">Q</th>
<th align="right">mass_gain</th>
<th align="right">Root</th>
<th align="right">Leaf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">0.0000116</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">0.0000231</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">0.0000347</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cable</span><span class="op">(</span><span class="va">result</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">21591</span>, <span class="fl">21661</span>, <span class="fl">10</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span> <span class="co"># around dawn</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">time</th>
<th align="right">Q</th>
<th align="right">mass_gain</th>
<th align="right">Root</th>
<th align="right">Leaf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.2498843</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">1.000000</td>
<td align="right">1.000000</td>
</tr>
<tr class="even">
<td align="right">0.2500000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">1.000000</td>
<td align="right">1.000000</td>
</tr>
<tr class="odd">
<td align="right">0.2501157</td>
<td align="right">0.0000015</td>
<td align="right">0.0000001</td>
<td align="right">1.000000</td>
<td align="right">1.000000</td>
</tr>
<tr class="even">
<td align="right">0.2502315</td>
<td align="right">0.0000029</td>
<td align="right">0.0000002</td>
<td align="right">1.000001</td>
<td align="right">1.000000</td>
</tr>
<tr class="odd">
<td align="right">0.2503472</td>
<td align="right">0.0000044</td>
<td align="right">0.0000002</td>
<td align="right">1.000003</td>
<td align="right">1.000001</td>
</tr>
<tr class="even">
<td align="right">0.2504630</td>
<td align="right">0.0000058</td>
<td align="right">0.0000003</td>
<td align="right">1.000005</td>
<td align="right">1.000001</td>
</tr>
<tr class="odd">
<td align="right">0.2505787</td>
<td align="right">0.0000073</td>
<td align="right">0.0000004</td>
<td align="right">1.000007</td>
<td align="right">1.000002</td>
</tr>
<tr class="even">
<td align="right">0.2506944</td>
<td align="right">0.0000087</td>
<td align="right">0.0000005</td>
<td align="right">1.000011</td>
<td align="right">1.000003</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cable</span><span class="op">(</span><span class="va">result</span><span class="op">[</span><span class="fl">43199</span><span class="op">:</span><span class="fl">43203</span>,<span class="op">]</span><span class="op">)</span> <span class="co"># around mid day</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">time</th>
<th align="right">Q</th>
<th align="right">mass_gain</th>
<th align="right">Root</th>
<th align="right">Leaf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.4999769</td>
<td align="right">0.002</td>
<td align="right">0.0001401</td>
<td align="right">2.338850</td>
<td align="right">1.334712</td>
</tr>
<tr class="even">
<td align="right">0.4999884</td>
<td align="right">0.002</td>
<td align="right">0.0001401</td>
<td align="right">2.338962</td>
<td align="right">1.334740</td>
</tr>
<tr class="odd">
<td align="right">0.5000000</td>
<td align="right">0.002</td>
<td align="right">0.0001402</td>
<td align="right">2.339074</td>
<td align="right">1.334769</td>
</tr>
<tr class="even">
<td align="right">0.5000116</td>
<td align="right">0.002</td>
<td align="right">0.0001402</td>
<td align="right">2.339186</td>
<td align="right">1.334796</td>
</tr>
<tr class="odd">
<td align="right">0.5000231</td>
<td align="right">0.002</td>
<td align="right">0.0001402</td>
<td align="right">2.339298</td>
<td align="right">1.334825</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cable</span><span class="op">(</span><span class="va">result</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">64741</span>, <span class="fl">64811</span>, <span class="fl">10</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span> <span class="co"># around dusk</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">time</th>
<th align="right">Q</th>
<th align="right">mass_gain</th>
<th align="right">Root</th>
<th align="right">Leaf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.7493056</td>
<td align="right">0.0000087</td>
<td align="right">0.0000008</td>
<td align="right">4.126557</td>
<td align="right">1.781639</td>
</tr>
<tr class="even">
<td align="right">0.7494213</td>
<td align="right">0.0000073</td>
<td align="right">0.0000007</td>
<td align="right">4.126563</td>
<td align="right">1.781641</td>
</tr>
<tr class="odd">
<td align="right">0.7495370</td>
<td align="right">0.0000058</td>
<td align="right">0.0000005</td>
<td align="right">4.126568</td>
<td align="right">1.781642</td>
</tr>
<tr class="even">
<td align="right">0.7496528</td>
<td align="right">0.0000044</td>
<td align="right">0.0000004</td>
<td align="right">4.126572</td>
<td align="right">1.781643</td>
</tr>
<tr class="odd">
<td align="right">0.7497685</td>
<td align="right">0.0000029</td>
<td align="right">0.0000003</td>
<td align="right">4.126575</td>
<td align="right">1.781644</td>
</tr>
<tr class="even">
<td align="right">0.7498843</td>
<td align="right">0.0000015</td>
<td align="right">0.0000001</td>
<td align="right">4.126576</td>
<td align="right">1.781644</td>
</tr>
<tr class="odd">
<td align="right">0.7500000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">4.126577</td>
<td align="right">1.781644</td>
</tr>
<tr class="even">
<td align="right">0.7501157</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">4.126577</td>
<td align="right">1.781644</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cable</span><span class="op">(</span><span class="va">result</span><span class="op">[</span><span class="fl">86398</span><span class="op">:</span><span class="fl">86401</span>,<span class="op">]</span><span class="op">)</span> <span class="co"># end</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">time</th>
<th align="right">Q</th>
<th align="right">mass_gain</th>
<th align="right">Root</th>
<th align="right">Leaf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.9999653</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4.126577</td>
<td align="right">1.781644</td>
</tr>
<tr class="even">
<td align="right">0.9999769</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4.126577</td>
<td align="right">1.781644</td>
</tr>
<tr class="odd">
<td align="right">0.9999884</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4.126577</td>
<td align="right">1.781644</td>
</tr>
<tr class="even">
<td align="right">1.0000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4.126577</td>
<td align="right">1.781644</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">Q</span> <span class="op">~</span> <span class="fl">24</span> <span class="op">*</span> <span class="va">time</span>, data <span class="op">=</span> <span class="va">result</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">24</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"hour"</span>, ylab <span class="op">=</span> <span class="st">"Q (mol / m^2 / s)"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">Leaf</span> <span class="op">~</span> <span class="fl">24</span> <span class="op">*</span> <span class="va">time</span>, data <span class="op">=</span> <span class="va">result</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">24</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"hour"</span>, ylab <span class="op">=</span> <span class="st">"Leaf (kg)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="BioCro-II_Paper--Section-1.1-example_files/figure-html/consistent-durations-1.png" width="50%"><img src="BioCro-II_Paper--Section-1.1-example_files/figure-html/consistent-durations-2.png" width="50%"></p>
</div>
<div class="section level2">
<h2 id="third-modification-making-the-time-variable-consistent-with-a-reasonable-time-of-year">Third modification: Making the <code>time</code> variable consistent
with a reasonable time of year<a class="anchor" aria-label="anchor" href="#third-modification-making-the-time-variable-consistent-with-a-reasonable-time-of-year"></a>
</h2>
<p>The simulation just shown takes care of making the time step
consistent with the time duration represented by the time column in its
usual interpretation. But the <code>time</code> value of 0 corresponds
(in the conventional BioCro interpretation) to midnight at the start of
December 31, and this is not consistent with a sun passing directly
overhead during the course of a 12 hour day, even at an equatorial
location. We may remedy this by shifting the time values forward by 79
days to the time of the March equinox. Now time represents not just a
duration in days, but more precisely, it represents the number of
(fractional) days that have elapsed since midnight at the start of
December 31 of the previous year. Direct modules that rely on this
meaning for time, such as <code>solar_position_michalsky</code>, could
now be used if we wished. (But we still can not mix in derivative
modules, such as the thermal time modules, that use <code>time</code> as
input, since these, unlike the <code>example_model_partitioning</code>
module we are using, assume the timestep value to be in hours, not
seconds.)</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">light_intensity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    time <span class="op">=</span> <span class="va">times</span><span class="op">/</span><span class="fl">86400</span> <span class="op">+</span> <span class="fl">79</span>,</span>
<span>    Q <span class="op">=</span> <span class="fu">Q</span><span class="op">(</span><span class="va">times</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_biocro.html">run_biocro</a></span><span class="op">(</span></span>
<span>    <span class="va">initial_values</span>,</span>
<span>    <span class="va">parameters</span>,</span>
<span>    <span class="va">light_intensity</span>,</span>
<span>    <span class="st">'BioCro:example_model_mass_gain'</span>,</span>
<span>    <span class="st">'BioCro:example_model_partitioning'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">cable</span><span class="op">(</span><span class="va">result</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="op">]</span><span class="op">)</span> <span class="co"># beginning</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">time</th>
<th align="right">Q</th>
<th align="right">mass_gain</th>
<th align="right">Root</th>
<th align="right">Leaf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">79.00000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">79.00001</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">79.00002</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">79.00003</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cable</span><span class="op">(</span><span class="va">result</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">21591</span>, <span class="fl">21661</span>, <span class="fl">10</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span> <span class="co"># around dawn</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">time</th>
<th align="right">Q</th>
<th align="right">mass_gain</th>
<th align="right">Root</th>
<th align="right">Leaf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">79.24988</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">1.000000</td>
<td align="right">1.000000</td>
</tr>
<tr class="even">
<td align="right">79.25000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">1.000000</td>
<td align="right">1.000000</td>
</tr>
<tr class="odd">
<td align="right">79.25012</td>
<td align="right">0.0000015</td>
<td align="right">0.0000001</td>
<td align="right">1.000000</td>
<td align="right">1.000000</td>
</tr>
<tr class="even">
<td align="right">79.25023</td>
<td align="right">0.0000029</td>
<td align="right">0.0000002</td>
<td align="right">1.000001</td>
<td align="right">1.000000</td>
</tr>
<tr class="odd">
<td align="right">79.25035</td>
<td align="right">0.0000044</td>
<td align="right">0.0000002</td>
<td align="right">1.000003</td>
<td align="right">1.000001</td>
</tr>
<tr class="even">
<td align="right">79.25046</td>
<td align="right">0.0000058</td>
<td align="right">0.0000003</td>
<td align="right">1.000005</td>
<td align="right">1.000001</td>
</tr>
<tr class="odd">
<td align="right">79.25058</td>
<td align="right">0.0000073</td>
<td align="right">0.0000004</td>
<td align="right">1.000007</td>
<td align="right">1.000002</td>
</tr>
<tr class="even">
<td align="right">79.25069</td>
<td align="right">0.0000087</td>
<td align="right">0.0000005</td>
<td align="right">1.000011</td>
<td align="right">1.000003</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cable</span><span class="op">(</span><span class="va">result</span><span class="op">[</span><span class="fl">43199</span><span class="op">:</span><span class="fl">43203</span>,<span class="op">]</span><span class="op">)</span> <span class="co"># around mid day</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">time</th>
<th align="right">Q</th>
<th align="right">mass_gain</th>
<th align="right">Root</th>
<th align="right">Leaf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">79.49998</td>
<td align="right">0.002</td>
<td align="right">0.0001401</td>
<td align="right">2.338850</td>
<td align="right">1.334712</td>
</tr>
<tr class="even">
<td align="right">79.49999</td>
<td align="right">0.002</td>
<td align="right">0.0001401</td>
<td align="right">2.338962</td>
<td align="right">1.334740</td>
</tr>
<tr class="odd">
<td align="right">79.50000</td>
<td align="right">0.002</td>
<td align="right">0.0001402</td>
<td align="right">2.339074</td>
<td align="right">1.334769</td>
</tr>
<tr class="even">
<td align="right">79.50001</td>
<td align="right">0.002</td>
<td align="right">0.0001402</td>
<td align="right">2.339186</td>
<td align="right">1.334796</td>
</tr>
<tr class="odd">
<td align="right">79.50002</td>
<td align="right">0.002</td>
<td align="right">0.0001402</td>
<td align="right">2.339298</td>
<td align="right">1.334825</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cable</span><span class="op">(</span><span class="va">result</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">64741</span>, <span class="fl">64811</span>, <span class="fl">10</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span> <span class="co"># around dusk</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">time</th>
<th align="right">Q</th>
<th align="right">mass_gain</th>
<th align="right">Root</th>
<th align="right">Leaf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">79.74931</td>
<td align="right">0.0000087</td>
<td align="right">0.0000008</td>
<td align="right">4.126557</td>
<td align="right">1.781639</td>
</tr>
<tr class="even">
<td align="right">79.74942</td>
<td align="right">0.0000073</td>
<td align="right">0.0000007</td>
<td align="right">4.126563</td>
<td align="right">1.781641</td>
</tr>
<tr class="odd">
<td align="right">79.74954</td>
<td align="right">0.0000058</td>
<td align="right">0.0000005</td>
<td align="right">4.126568</td>
<td align="right">1.781642</td>
</tr>
<tr class="even">
<td align="right">79.74965</td>
<td align="right">0.0000044</td>
<td align="right">0.0000004</td>
<td align="right">4.126572</td>
<td align="right">1.781643</td>
</tr>
<tr class="odd">
<td align="right">79.74977</td>
<td align="right">0.0000029</td>
<td align="right">0.0000003</td>
<td align="right">4.126575</td>
<td align="right">1.781644</td>
</tr>
<tr class="even">
<td align="right">79.74988</td>
<td align="right">0.0000015</td>
<td align="right">0.0000001</td>
<td align="right">4.126576</td>
<td align="right">1.781644</td>
</tr>
<tr class="odd">
<td align="right">79.75000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">4.126577</td>
<td align="right">1.781644</td>
</tr>
<tr class="even">
<td align="right">79.75012</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">4.126577</td>
<td align="right">1.781644</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cable</span><span class="op">(</span><span class="va">result</span><span class="op">[</span><span class="fl">86398</span><span class="op">:</span><span class="fl">86401</span>,<span class="op">]</span><span class="op">)</span> <span class="co"># end</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">time</th>
<th align="right">Q</th>
<th align="right">mass_gain</th>
<th align="right">Root</th>
<th align="right">Leaf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">79.99997</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4.126577</td>
<td align="right">1.781644</td>
</tr>
<tr class="even">
<td align="right">79.99998</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4.126577</td>
<td align="right">1.781644</td>
</tr>
<tr class="odd">
<td align="right">79.99999</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4.126577</td>
<td align="right">1.781644</td>
</tr>
<tr class="even">
<td align="right">80.00000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4.126577</td>
<td align="right">1.781644</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">Q</span> <span class="op">~</span> <span class="fl">24</span> <span class="op">*</span> <span class="op">(</span><span class="va">time</span> <span class="op">-</span> <span class="fl">79</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">result</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">24</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"hour of the 79th day of the year\n(March 20)"</span>, ylab <span class="op">=</span> <span class="st">"Q (mol / m^2 / s)"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">Leaf</span> <span class="op">~</span> <span class="fl">24</span> <span class="op">*</span> <span class="op">(</span><span class="va">time</span> <span class="op">-</span> <span class="fl">79</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">result</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">24</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"hour of the 79th day of the year\n(March 20)"</span>, ylab <span class="op">=</span> <span class="st">"Leaf (kg)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="BioCro-II_Paper--Section-1.1-example_files/figure-html/realistic-time-of-year-1.png" width="50%"><img src="BioCro-II_Paper--Section-1.1-example_files/figure-html/realistic-time-of-year-2.png" width="50%"></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-10.1093/insilicoplants/diac003" class="csl-entry">
Lochocki, Edward B, Scott Rohde, Deepak Jaiswal, Megan L Matthews,
Fernando Miguez, Stephen P Long, and Justin M McGrath. 2022.
<span>“<span class="nocase">BioCro II: a software package for modular
crop growth simulations</span>.”</span> <em>In Silico Plants</em> 4 (1).
<a href="https://doi.org/10.1093/insilicoplants/diac003" class="external-link">https://doi.org/10.1093/insilicoplants/diac003</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Justin M. McGrath, Edward B. Lochocki, Scott Rohde, Deepak Jaiswal, Megan L. Matthews, Fernando E. Miguez, Stephen P. Long.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
