<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The BioCro C++ Library: /github/workspace/src/framework/numerical_jacobian.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">The BioCro C++ Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_5752cadd8276ecfd63d9b924f2a4d4b5.html">framework</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">numerical_jacobian.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;algorithm&gt;</code><br />
<code>#include &lt;memory&gt;</code><br />
<code>#include &quot;<a class="el" href="constants_8h_source.html">constants.h</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for numerical_jacobian.h:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="numerical__jacobian_8h__incl.png" border="0" usemap="#a_2github_2workspace_2src_2framework_2numerical__jacobian_8h" alt=""/></div>
<map name="a_2github_2workspace_2src_2framework_2numerical__jacobian_8h" id="a_2github_2workspace_2src_2framework_2numerical__jacobian_8h">
<area shape="rect" title=" " alt="" coords="98,5,249,61"/>
<area shape="rect" title=" " alt="" coords="5,109,64,136"/>
<area shape="rect" title=" " alt="" coords="88,109,163,136"/>
<area shape="rect" title=" " alt="" coords="187,109,255,136"/>
<area shape="rect" href="constants_8h.html" title=" " alt="" coords="279,109,369,136"/>
<area shape="rect" title=" " alt="" coords="250,184,398,225"/>
</map>
</div>
</div><div class="textblock"><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="numerical__jacobian_8h__dep__incl.png" border="0" usemap="#a_2github_2workspace_2src_2framework_2numerical__jacobian_8hdep" alt=""/></div>
<map name="a_2github_2workspace_2src_2framework_2numerical__jacobian_8hdep" id="a_2github_2workspace_2src_2framework_2numerical__jacobian_8hdep">
<area shape="rect" title=" " alt="" coords="140,5,291,61"/>
<area shape="rect" href="dynamical__system__caller_8h.html" title=" " alt="" coords="140,109,291,165"/>
<area shape="rect" href="boost__ode__solvers_8h.html" title=" " alt="" coords="122,213,309,269"/>
<area shape="rect" href="auto__ode__solver_8h.html" title=" " alt="" coords="5,317,177,373"/>
<area shape="rect" href="ode__solver__factory_8cpp.html" title=" " alt="" coords="53,421,253,477"/>
<area shape="rect" href="boost__ode__solvers_8cpp.html" title=" " alt="" coords="253,317,453,373"/>
</map>
</div>
</div>
<p><a href="numerical__jacobian_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab9edec9fd459b0eb500dbd993b51e0f6"><td class="memTemplParams" colspan="2">template&lt;typename equation_ptr_type , typename vector_type , typename time_type , typename matrix_type &gt; </td></tr>
<tr class="memitem:ab9edec9fd459b0eb500dbd993b51e0f6"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="numerical__jacobian_8h.html#ab9edec9fd459b0eb500dbd993b51e0f6">calculate_jacobian</a> (equation_ptr_type const &amp;equation_ptr, vector_type const &amp;x, time_type t, vector_type const &amp;f_current, matrix_type &amp;jacobi)</td></tr>
<tr class="memdesc:ab9edec9fd459b0eb500dbd993b51e0f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Numerically compute the Jacobian matrix of a vector valued function.  <a href="numerical__jacobian_8h.html#ab9edec9fd459b0eb500dbd993b51e0f6">More...</a><br /></td></tr>
<tr class="separator:ab9edec9fd459b0eb500dbd993b51e0f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4613d2383d8cc1f150cfda00be21ce7"><td class="memTemplParams" colspan="2">template&lt;typename equation_ptr_type , typename vector_type , typename time_type , typename matrix_type &gt; </td></tr>
<tr class="memitem:aa4613d2383d8cc1f150cfda00be21ce7"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="numerical__jacobian_8h.html#aa4613d2383d8cc1f150cfda00be21ce7">calculate_jacobian</a> (equation_ptr_type const &amp;equation_ptr, vector_type const &amp;x, time_type t, matrix_type &amp;jacobi)</td></tr>
<tr class="memdesc:aa4613d2383d8cc1f150cfda00be21ce7"><td class="mdescLeft">&#160;</td><td class="mdescRight">A wrapper for the five-argument version of <code><a class="el" href="numerical__jacobian_8h.html#ab9edec9fd459b0eb500dbd993b51e0f6" title="Numerically compute the Jacobian matrix of a vector valued function.">calculate_jacobian()</a></code> that automatically evaluates <code>f_current</code>.  <a href="numerical__jacobian_8h.html#aa4613d2383d8cc1f150cfda00be21ce7">More...</a><br /></td></tr>
<tr class="separator:aa4613d2383d8cc1f150cfda00be21ce7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69dfb9062da0c3010b7da3c5fd1e5019"><td class="memTemplParams" colspan="2">template&lt;typename equation_ptr_type , typename vector_type , typename matrix_type &gt; </td></tr>
<tr class="memitem:a69dfb9062da0c3010b7da3c5fd1e5019"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="numerical__jacobian_8h.html#a69dfb9062da0c3010b7da3c5fd1e5019">calculate_jacobian</a> (equation_ptr_type const &amp;equation_ptr, vector_type const &amp;x, vector_type const &amp;f_current, matrix_type &amp;jacobi)</td></tr>
<tr class="memdesc:a69dfb9062da0c3010b7da3c5fd1e5019"><td class="mdescLeft">&#160;</td><td class="mdescRight">A wrapper for the five-argument version of <code><a class="el" href="numerical__jacobian_8h.html#ab9edec9fd459b0eb500dbd993b51e0f6" title="Numerically compute the Jacobian matrix of a vector valued function.">calculate_jacobian()</a></code> for equations that have no time dependence.  <a href="numerical__jacobian_8h.html#a69dfb9062da0c3010b7da3c5fd1e5019">More...</a><br /></td></tr>
<tr class="separator:a69dfb9062da0c3010b7da3c5fd1e5019"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a411d7612ae5724433229164df24dc1ad"><td class="memTemplParams" colspan="2">template&lt;typename equation_ptr_type , typename vector_type , typename matrix_type &gt; </td></tr>
<tr class="memitem:a411d7612ae5724433229164df24dc1ad"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="numerical__jacobian_8h.html#a411d7612ae5724433229164df24dc1ad">calculate_jacobian</a> (equation_ptr_type const &amp;equation_ptr, vector_type const &amp;x, matrix_type &amp;jacobi)</td></tr>
<tr class="memdesc:a411d7612ae5724433229164df24dc1ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">A wrapper for the five-argument version of <code><a class="el" href="numerical__jacobian_8h.html#ab9edec9fd459b0eb500dbd993b51e0f6" title="Numerically compute the Jacobian matrix of a vector valued function.">calculate_jacobian()</a></code> that automatically evaluates <code>f_current</code> for equations that have no time dependence.  <a href="numerical__jacobian_8h.html#a411d7612ae5724433229164df24dc1ad">More...</a><br /></td></tr>
<tr class="separator:a411d7612ae5724433229164df24dc1ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18e7949927b0bfc86140b3534e790e8c"><td class="memTemplParams" colspan="2">template&lt;typename equation_ptr_type , typename time_type , typename vector_type &gt; </td></tr>
<tr class="memitem:a18e7949927b0bfc86140b3534e790e8c"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="numerical__jacobian_8h.html#a18e7949927b0bfc86140b3534e790e8c">calculate_time_derivative</a> (equation_ptr_type const &amp;equation_ptr, time_type max_time, vector_type const &amp;x, time_type t, vector_type const &amp;f_current, vector_type &amp;dfdt)</td></tr>
<tr class="memdesc:a18e7949927b0bfc86140b3534e790e8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Numerically compute the explicit time derivatives of a vector valued function.  <a href="numerical__jacobian_8h.html#a18e7949927b0bfc86140b3534e790e8c">More...</a><br /></td></tr>
<tr class="separator:a18e7949927b0bfc86140b3534e790e8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a926532563be19071bb0594d54846edcb"><td class="memTemplParams" colspan="2">template&lt;typename equation_ptr_type , typename time_type , typename vector_type &gt; </td></tr>
<tr class="memitem:a926532563be19071bb0594d54846edcb"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="numerical__jacobian_8h.html#a926532563be19071bb0594d54846edcb">calculate_time_derivative</a> (equation_ptr_type const &amp;equation_ptr, time_type max_time, vector_type const &amp;x, time_type t, vector_type &amp;dfdt)</td></tr>
<tr class="memdesc:a926532563be19071bb0594d54846edcb"><td class="mdescLeft">&#160;</td><td class="mdescRight">A wrapper for the six-argument version of <code><a class="el" href="numerical__jacobian_8h.html#a18e7949927b0bfc86140b3534e790e8c" title="Numerically compute the explicit time derivatives of a vector valued function.">calculate_time_derivative()</a></code> that automatically calculates <code>f_current</code>.  <a href="numerical__jacobian_8h.html#a926532563be19071bb0594d54846edcb">More...</a><br /></td></tr>
<tr class="separator:a926532563be19071bb0594d54846edcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa69a62289bcec362abb76d68df65e6d3"><td class="memTemplParams" colspan="2">template&lt;typename equation_ptr_type , typename time_type , typename vector_type , typename matrix_type &gt; </td></tr>
<tr class="memitem:aa69a62289bcec362abb76d68df65e6d3"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="numerical__jacobian_8h.html#aa69a62289bcec362abb76d68df65e6d3">calculate_jacobian_and_time_derivative</a> (equation_ptr_type const &amp;equation_ptr, time_type max_time, vector_type const &amp;x, time_type t, matrix_type &amp;jacobi, vector_type &amp;dfdt)</td></tr>
<tr class="memdesc:aa69a62289bcec362abb76d68df65e6d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Numerically compute the Jacobian matrix and the explicit time derivative of a vector valued function.  <a href="numerical__jacobian_8h.html#aa69a62289bcec362abb76d68df65e6d3">More...</a><br /></td></tr>
<tr class="separator:aa69a62289bcec362abb76d68df65e6d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a411d7612ae5724433229164df24dc1ad" name="a411d7612ae5724433229164df24dc1ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a411d7612ae5724433229164df24dc1ad">&#9670;&nbsp;</a></span>calculate_jacobian() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calculate_jacobian </td>
          <td>(</td>
          <td class="paramtype">equation_ptr_type const &amp;&#160;</td>
          <td class="paramname"><em>equation_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector_type const &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">matrix_type &amp;&#160;</td>
          <td class="paramname"><em>jacobi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A wrapper for the five-argument version of <code><a class="el" href="numerical__jacobian_8h.html#ab9edec9fd459b0eb500dbd993b51e0f6" title="Numerically compute the Jacobian matrix of a vector valued function.">calculate_jacobian()</a></code> that automatically evaluates <code>f_current</code> for equations that have no time dependence. </p>

<p class="definition">Definition at line <a class="el" href="numerical__jacobian_8h_source.html#l00197">197</a> of file <a class="el" href="numerical__jacobian_8h_source.html">numerical_jacobian.h</a>.</p>

<p class="reference">References <a class="el" href="numerical__jacobian_8h_source.html#l00108">calculate_jacobian()</a>.</p>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="numerical__jacobian_8h_a411d7612ae5724433229164df24dc1ad_cgraph.png" border="0" usemap="#anumerical__jacobian_8h_a411d7612ae5724433229164df24dc1ad_cgraph" alt=""/></div>
<map name="anumerical__jacobian_8h_a411d7612ae5724433229164df24dc1ad_cgraph" id="anumerical__jacobian_8h_a411d7612ae5724433229164df24dc1ad_cgraph">
<area shape="rect" title="A wrapper for the five&#45;argument version of calculate_jacobian() that automatically evaluates f_curren..." alt="" coords="5,5,135,32"/>
<area shape="rect" href="numerical__jacobian_8h.html#ab9edec9fd459b0eb500dbd993b51e0f6" title="Numerically compute the Jacobian matrix of a vector valued function." alt="" coords="183,5,312,32"/>
<area shape="rect" href="dynamical__system_8h.html#a3663e16fd2cb02e7095f93993cf8f463" title="Define evaluation behavior for a set of equations defined by a dynamical_system object...." alt="" coords="360,5,495,32"/>
</map>
</div>

</div>
</div>
<a id="aa4613d2383d8cc1f150cfda00be21ce7" name="aa4613d2383d8cc1f150cfda00be21ce7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4613d2383d8cc1f150cfda00be21ce7">&#9670;&nbsp;</a></span>calculate_jacobian() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calculate_jacobian </td>
          <td>(</td>
          <td class="paramtype">equation_ptr_type const &amp;&#160;</td>
          <td class="paramname"><em>equation_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector_type const &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_type&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">matrix_type &amp;&#160;</td>
          <td class="paramname"><em>jacobi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A wrapper for the five-argument version of <code><a class="el" href="numerical__jacobian_8h.html#ab9edec9fd459b0eb500dbd993b51e0f6" title="Numerically compute the Jacobian matrix of a vector valued function.">calculate_jacobian()</a></code> that automatically evaluates <code>f_current</code>. </p>

<p class="definition">Definition at line <a class="el" href="numerical__jacobian_8h_source.html#l00162">162</a> of file <a class="el" href="numerical__jacobian_8h_source.html">numerical_jacobian.h</a>.</p>

<p class="reference">References <a class="el" href="numerical__jacobian_8h_source.html#l00108">calculate_jacobian()</a>, and <a class="el" href="dynamical__system_8h_source.html#l00470">evaluate_equations()</a>.</p>
<div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="numerical__jacobian_8h_aa4613d2383d8cc1f150cfda00be21ce7_cgraph.png" border="0" usemap="#anumerical__jacobian_8h_aa4613d2383d8cc1f150cfda00be21ce7_cgraph" alt=""/></div>
<map name="anumerical__jacobian_8h_aa4613d2383d8cc1f150cfda00be21ce7_cgraph" id="anumerical__jacobian_8h_aa4613d2383d8cc1f150cfda00be21ce7_cgraph">
<area shape="rect" title="A wrapper for the five&#45;argument version of calculate_jacobian() that automatically evaluates f_curren..." alt="" coords="5,31,135,57"/>
<area shape="rect" href="numerical__jacobian_8h.html#ab9edec9fd459b0eb500dbd993b51e0f6" title="Numerically compute the Jacobian matrix of a vector valued function." alt="" coords="183,5,312,32"/>
<area shape="rect" href="dynamical__system_8h.html#a3663e16fd2cb02e7095f93993cf8f463" title="Define evaluation behavior for a set of equations defined by a dynamical_system object...." alt="" coords="360,31,495,57"/>
</map>
</div>

</div>
</div>
<a id="ab9edec9fd459b0eb500dbd993b51e0f6" name="ab9edec9fd459b0eb500dbd993b51e0f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9edec9fd459b0eb500dbd993b51e0f6">&#9670;&nbsp;</a></span>calculate_jacobian() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calculate_jacobian </td>
          <td>(</td>
          <td class="paramtype">equation_ptr_type const &amp;&#160;</td>
          <td class="paramname"><em>equation_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector_type const &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_type&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector_type const &amp;&#160;</td>
          <td class="paramname"><em>f_current</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">matrix_type &amp;&#160;</td>
          <td class="paramname"><em>jacobi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Numerically compute the Jacobian matrix of a vector valued function. </p>
<p >The Jacobian \( \mathbf{J} \) of a vector-valued function \( \vec{f} (\vec{x}, t) \) is a matrix whose elements are defined by \( J_{i,j} = \frac{\partial f_i}{\partial x_j} \), where \( f_i \) is the \( i^{th} \) component of \( \vec{f} \) and \( x_j \) is the \( j^{th} \) component of \( \vec{x} \). (Here, \( t \) is a scalar.) In other words, each element of \( \mathbf{J} \) is itself a function of \( \vec{x} \) and \( t \) defined by one of the possible partial derivatives of \( \vec{f} \) with respect to the elements of \( \vec{x} \). For more information, see the <a href="https://en.wikipedia.org/wiki/Jacobian_matrix_and_determinant" target="_blank">Wikpedia page for the Jacobian matrix</a>.</p>
<p >Here, we numerically calculate the value of the Jacobian matrix at particular values of \( \vec{x} \) and \( t \). To do this, we use the simplest (but not the most accurate) method for estimating the value of each partial derivative in the matrix. This can be classified as the "forward
perturbation method" and is defined as follows:</p>
<p class="formulaDsp">
\[
  \frac{\partial f_i}{\partial x_j} \approx
    \frac{f_i(\vec{x} + h \cdot \vec{e}_j) - f_i(\vec{x})}{h},
\]
</p>
<p >where \( h \) is a small number and \( \vec{e}_j \) is the unit vector in the \( j \) direction. \( h \) is calculated to be a small fraction of \( x_j \), or a minimal value when \( x_j = 0 \).</p>
<p >By using this method, we are avoiding more complex options that determine an optimal value for \( h \), that consider forward and backward perturbations, or that consider additional terms in the Taylor series for \( \vec{f} \). For our purposes, the additional computational costs inherent to these methods do not justify the marginal increases in accuracy. For example, see this discussion of step size from <a href="http://www.iue.tuwien.ac.at/phd/khalil/node14.html" target="_blank">Nadim Khalil's thesis</a>:</p>
<blockquote class="doxtable">
<p >&zwj;It is also known that numerical differentiation is an unstable procedure prone to truncation and subtractive cancellation errors. Decreasing the step size [ \( h \) in the equation above] will reduce the truncation error. Unfortunately a smaller step has the opposite effect on the cancellation error. Selecting the <em>optimal</em> step size for a certain problem is computationally expensive and the benefits achieved are not justifiable as the effect of small errors in the values of the elements of the Jacobian matrix is minor. For this reason, the sizing of the finite difference step is not attempted and a constant increment size is used in evaluating the gradient. </p>
</blockquote>
<p>Also note that in general, if \( \vec{x} \) has \( N \) elements, then calculating the Jacobian using the forward pertubration scheme requires \( N + 1 \) function evaluations, while using forward and backward perturbations requires \( 2 N \). Likewise, higher-order alternatives also add a large number of function evaluations. Function evaluations are expensive in BioCro, so it is important to use them sparingly.</p>
<p >When calculating numerical derivatives, roundoff error in the value of the step size \( h \) can have a significant effect. For that reason, it is important to ensure that \( h \) is exactly representable in the computer architecture. This can be accomplished using a simple scheme like</p>
<blockquote class="doxtable">
<p >&zwj;<code>double volatile temp = x + h;</code></p>
<p ><code>h = temp - x;</code> </p>
</blockquote>
<p>The <code>volatile</code> keyword ensures that the compiler's optimizer does not eliminate this reassignment process. For more information about this issue, see Section 5.7 of <em>Numerical Recipes in C</em>, <a href="http://s3.amazonaws.com/nrbook.com/book_C210.html" target="_blank">2nd Edition</a> or <a href="http://numerical.recipes/book/book.html" target="_blank">3rd Edition</a>.</p>
<p >In BioCro, the Jacobian is almost always calculated for the case where \( \vec{f}(\vec{x}, t) = d \vec{x} / dt \). In this case, \( \vec{x} \) and \( \vec{y} = \vec{f}(\vec{x}, t) \) have the same dimension. Even in other BioCro applications where \( \vec{f}(\vec{x}, t) \) is not the time derivative of \( \vec{x} \), this restriction on dimensionality still holds. Because of this, here we assume that the output from \( \vec{f} \) <em>always</em> has the same length as \( \vec{x} \).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">equation_ptr</td><td>a pointer to an object that can be used to represent a vector valued function <code>f(x, t)</code>. There must be an associated <code>evaluate_equations(*equation_ptr_type, x, t, y)</code> function defined for <code>equation_ptr_type</code>. It is assumed that the output vector produced by the equations has the same length as the input vector.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>an input vector to be passed to <code>f</code>.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>an input time to be passed to <code>f</code>.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f_current</td><td>the output of <code>f</code> evaluated at <code>x</code> and <code>t</code></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">jacobi</td><td>the calculated Jacobian matrix (containing the partial derivatives \( \partial{f_i}/\partial{x_j} \) evaluated at <code>x</code> and <code>t</code>) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="numerical__jacobian_8h_source.html#l00108">108</a> of file <a class="el" href="numerical__jacobian_8h_source.html">numerical_jacobian.h</a>.</p>

<p class="reference">References <a class="el" href="constants_8h_source.html#l00021">calculation_constants::eps_deriv</a>, and <a class="el" href="dynamical__system_8h_source.html#l00470">evaluate_equations()</a>.</p>

<p class="reference">Referenced by <a class="el" href="numerical__jacobian_8h_source.html#l00162">calculate_jacobian()</a>, and <a class="el" href="numerical__jacobian_8h_source.html#l00365">calculate_jacobian_and_time_derivative()</a>.</p>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="numerical__jacobian_8h_ab9edec9fd459b0eb500dbd993b51e0f6_cgraph.png" border="0" usemap="#anumerical__jacobian_8h_ab9edec9fd459b0eb500dbd993b51e0f6_cgraph" alt=""/></div>
<map name="anumerical__jacobian_8h_ab9edec9fd459b0eb500dbd993b51e0f6_cgraph" id="anumerical__jacobian_8h_ab9edec9fd459b0eb500dbd993b51e0f6_cgraph">
<area shape="rect" title="Numerically compute the Jacobian matrix of a vector valued function." alt="" coords="5,5,135,32"/>
<area shape="rect" href="dynamical__system_8h.html#a3663e16fd2cb02e7095f93993cf8f463" title="Define evaluation behavior for a set of equations defined by a dynamical_system object...." alt="" coords="183,5,317,32"/>
</map>
</div>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="numerical__jacobian_8h_ab9edec9fd459b0eb500dbd993b51e0f6_icgraph.png" border="0" usemap="#anumerical__jacobian_8h_ab9edec9fd459b0eb500dbd993b51e0f6_icgraph" alt=""/></div>
<map name="anumerical__jacobian_8h_ab9edec9fd459b0eb500dbd993b51e0f6_icgraph" id="anumerical__jacobian_8h_ab9edec9fd459b0eb500dbd993b51e0f6_icgraph">
<area shape="rect" title="Numerically compute the Jacobian matrix of a vector valued function." alt="" coords="421,35,551,61"/>
<area shape="rect" href="numerical__jacobian_8h.html#aa4613d2383d8cc1f150cfda00be21ce7" title="A wrapper for the five&#45;argument version of calculate_jacobian() that automatically evaluates f_curren..." alt="" coords="236,5,365,32"/>
<area shape="rect" href="numerical__jacobian_8h.html#aa69a62289bcec362abb76d68df65e6d3" title="Numerically compute the Jacobian matrix and the explicit time derivative of a vector valued function." alt="" coords="228,57,373,98"/>
<area shape="rect" href="classdynamical__system__pointer__wrapper.html#a3e467d4b57d62daa470ec61486a02152" title=" " alt="" coords="5,57,180,98"/>
</map>
</div>

</div>
</div>
<a id="a69dfb9062da0c3010b7da3c5fd1e5019" name="a69dfb9062da0c3010b7da3c5fd1e5019"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69dfb9062da0c3010b7da3c5fd1e5019">&#9670;&nbsp;</a></span>calculate_jacobian() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calculate_jacobian </td>
          <td>(</td>
          <td class="paramtype">equation_ptr_type const &amp;&#160;</td>
          <td class="paramname"><em>equation_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector_type const &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector_type const &amp;&#160;</td>
          <td class="paramname"><em>f_current</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">matrix_type &amp;&#160;</td>
          <td class="paramname"><em>jacobi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A wrapper for the five-argument version of <code><a class="el" href="numerical__jacobian_8h.html#ab9edec9fd459b0eb500dbd993b51e0f6" title="Numerically compute the Jacobian matrix of a vector valued function.">calculate_jacobian()</a></code> for equations that have no time dependence. </p>

<p class="definition">Definition at line <a class="el" href="numerical__jacobian_8h_source.html#l00180">180</a> of file <a class="el" href="numerical__jacobian_8h_source.html">numerical_jacobian.h</a>.</p>

<p class="reference">References <a class="el" href="numerical__jacobian_8h_source.html#l00108">calculate_jacobian()</a>.</p>
<div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="numerical__jacobian_8h_a69dfb9062da0c3010b7da3c5fd1e5019_cgraph.png" border="0" usemap="#anumerical__jacobian_8h_a69dfb9062da0c3010b7da3c5fd1e5019_cgraph" alt=""/></div>
<map name="anumerical__jacobian_8h_a69dfb9062da0c3010b7da3c5fd1e5019_cgraph" id="anumerical__jacobian_8h_a69dfb9062da0c3010b7da3c5fd1e5019_cgraph">
<area shape="rect" title="A wrapper for the five&#45;argument version of calculate_jacobian() for equations that have no time depen..." alt="" coords="5,5,135,32"/>
<area shape="rect" href="numerical__jacobian_8h.html#ab9edec9fd459b0eb500dbd993b51e0f6" title="Numerically compute the Jacobian matrix of a vector valued function." alt="" coords="183,5,312,32"/>
<area shape="rect" href="dynamical__system_8h.html#a3663e16fd2cb02e7095f93993cf8f463" title="Define evaluation behavior for a set of equations defined by a dynamical_system object...." alt="" coords="360,5,495,32"/>
</map>
</div>

</div>
</div>
<a id="aa69a62289bcec362abb76d68df65e6d3" name="aa69a62289bcec362abb76d68df65e6d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa69a62289bcec362abb76d68df65e6d3">&#9670;&nbsp;</a></span>calculate_jacobian_and_time_derivative()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calculate_jacobian_and_time_derivative </td>
          <td>(</td>
          <td class="paramtype">equation_ptr_type const &amp;&#160;</td>
          <td class="paramname"><em>equation_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_type&#160;</td>
          <td class="paramname"><em>max_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector_type const &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_type&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">matrix_type &amp;&#160;</td>
          <td class="paramname"><em>jacobi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector_type &amp;&#160;</td>
          <td class="paramname"><em>dfdt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Numerically compute the Jacobian matrix and the explicit time derivative of a vector valued function. </p>
<p >This function simply calls <code><a class="el" href="numerical__jacobian_8h.html#ab9edec9fd459b0eb500dbd993b51e0f6" title="Numerically compute the Jacobian matrix of a vector valued function.">calculate_jacobian()</a></code> and <code><a class="el" href="numerical__jacobian_8h.html#a18e7949927b0bfc86140b3534e790e8c" title="Numerically compute the explicit time derivatives of a vector valued function.">calculate_time_derivative()</a></code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">equation_ptr</td><td>a pointer to an object that can be used to represent a vector valued function <code>f(x, t)</code>. There must be an associated <code>evaluate_equations(*equation_ptr_type, x, t, y)</code> function defined for <code>equation_ptr_type</code>. It is assumed that the output vector produced by the equations has the same length as the input vector.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">max_time</td><td>the largest time value that can be passed to <code>f</code>.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>an input vector to be passed to <code>f</code>.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>an input time to be passed to <code>f</code>.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">jacobi</td><td>the calculated Jacobian matrix (containing the partial derivatives \( \partial{f_i}/\partial{x_j} \) evaluated at <code>x</code> and <code>t</code>)</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dfdt</td><td>the calculated time derivative, i.e., the vector of derivatives \( df_i / dt \) evaluated at <code>x</code> and <code>t</code>. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="numerical__jacobian_8h_source.html#l00365">365</a> of file <a class="el" href="numerical__jacobian_8h_source.html">numerical_jacobian.h</a>.</p>

<p class="reference">References <a class="el" href="numerical__jacobian_8h_source.html#l00108">calculate_jacobian()</a>, <a class="el" href="numerical__jacobian_8h_source.html#l00264">calculate_time_derivative()</a>, and <a class="el" href="dynamical__system_8h_source.html#l00470">evaluate_equations()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dynamical__system__caller_8h_source.html#l00027">dynamical_system_pointer_wrapper::operator()()</a>.</p>
<div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="numerical__jacobian_8h_aa69a62289bcec362abb76d68df65e6d3_cgraph.png" border="0" usemap="#anumerical__jacobian_8h_aa69a62289bcec362abb76d68df65e6d3_cgraph" alt=""/></div>
<map name="anumerical__jacobian_8h_aa69a62289bcec362abb76d68df65e6d3_cgraph" id="anumerical__jacobian_8h_aa69a62289bcec362abb76d68df65e6d3_cgraph">
<area shape="rect" title="Numerically compute the Jacobian matrix and the explicit time derivative of a vector valued function." alt="" coords="5,49,151,90"/>
<area shape="rect" href="numerical__jacobian_8h.html#ab9edec9fd459b0eb500dbd993b51e0f6" title="Numerically compute the Jacobian matrix of a vector valued function." alt="" coords="219,5,348,32"/>
<area shape="rect" href="dynamical__system_8h.html#a3663e16fd2cb02e7095f93993cf8f463" title="Define evaluation behavior for a set of equations defined by a dynamical_system object...." alt="" coords="416,56,551,83"/>
<area shape="rect" href="numerical__jacobian_8h.html#a18e7949927b0bfc86140b3534e790e8c" title="Numerically compute the explicit time derivatives of a vector valued function." alt="" coords="199,107,368,133"/>
</map>
</div>
<div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="numerical__jacobian_8h_aa69a62289bcec362abb76d68df65e6d3_icgraph.png" border="0" usemap="#anumerical__jacobian_8h_aa69a62289bcec362abb76d68df65e6d3_icgraph" alt=""/></div>
<map name="anumerical__jacobian_8h_aa69a62289bcec362abb76d68df65e6d3_icgraph" id="anumerical__jacobian_8h_aa69a62289bcec362abb76d68df65e6d3_icgraph">
<area shape="rect" title="Numerically compute the Jacobian matrix and the explicit time derivative of a vector valued function." alt="" coords="228,5,373,47"/>
<area shape="rect" href="classdynamical__system__pointer__wrapper.html#a3e467d4b57d62daa470ec61486a02152" title=" " alt="" coords="5,5,180,47"/>
</map>
</div>

</div>
</div>
<a id="a926532563be19071bb0594d54846edcb" name="a926532563be19071bb0594d54846edcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a926532563be19071bb0594d54846edcb">&#9670;&nbsp;</a></span>calculate_time_derivative() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calculate_time_derivative </td>
          <td>(</td>
          <td class="paramtype">equation_ptr_type const &amp;&#160;</td>
          <td class="paramname"><em>equation_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_type&#160;</td>
          <td class="paramname"><em>max_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector_type const &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_type&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector_type &amp;&#160;</td>
          <td class="paramname"><em>dfdt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A wrapper for the six-argument version of <code><a class="el" href="numerical__jacobian_8h.html#a18e7949927b0bfc86140b3534e790e8c" title="Numerically compute the explicit time derivatives of a vector valued function.">calculate_time_derivative()</a></code> that automatically calculates <code>f_current</code>. </p>

<p class="definition">Definition at line <a class="el" href="numerical__jacobian_8h_source.html#l00322">322</a> of file <a class="el" href="numerical__jacobian_8h_source.html">numerical_jacobian.h</a>.</p>

<p class="reference">References <a class="el" href="numerical__jacobian_8h_source.html#l00264">calculate_time_derivative()</a>, and <a class="el" href="dynamical__system_8h_source.html#l00470">evaluate_equations()</a>.</p>
<div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><img src="numerical__jacobian_8h_a926532563be19071bb0594d54846edcb_cgraph.png" border="0" usemap="#anumerical__jacobian_8h_a926532563be19071bb0594d54846edcb_cgraph" alt=""/></div>
<map name="anumerical__jacobian_8h_a926532563be19071bb0594d54846edcb_cgraph" id="anumerical__jacobian_8h_a926532563be19071bb0594d54846edcb_cgraph">
<area shape="rect" title="A wrapper for the six&#45;argument version of calculate_time_derivative() that automatically calculates f..." alt="" coords="5,31,175,57"/>
<area shape="rect" href="numerical__jacobian_8h.html#a18e7949927b0bfc86140b3534e790e8c" title="Numerically compute the explicit time derivatives of a vector valued function." alt="" coords="223,5,392,32"/>
<area shape="rect" href="dynamical__system_8h.html#a3663e16fd2cb02e7095f93993cf8f463" title="Define evaluation behavior for a set of equations defined by a dynamical_system object...." alt="" coords="440,31,575,57"/>
</map>
</div>

</div>
</div>
<a id="a18e7949927b0bfc86140b3534e790e8c" name="a18e7949927b0bfc86140b3534e790e8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18e7949927b0bfc86140b3534e790e8c">&#9670;&nbsp;</a></span>calculate_time_derivative() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calculate_time_derivative </td>
          <td>(</td>
          <td class="paramtype">equation_ptr_type const &amp;&#160;</td>
          <td class="paramname"><em>equation_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_type&#160;</td>
          <td class="paramname"><em>max_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector_type const &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_type&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector_type const &amp;&#160;</td>
          <td class="paramname"><em>f_current</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector_type &amp;&#160;</td>
          <td class="paramname"><em>dfdt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Numerically compute the explicit time derivatives of a vector valued function. </p>
<p >Here, the explicit time derivative of a vector-valued function \( \vec{f}(\vec{x}, t) \) is calculated numerically using</p>
<p class="formulaDsp">
\[
  \frac{d f_i}{dt} \approx \frac{f_i(\vec{x}, t + h) - f_i(\vec{x}, t)}{h},
\]
</p>
<p >where \( f_i \) is the \( i^{th} \) component of \( \vec{f} \). As is the case with the partial derivatives of <code><a class="el" href="numerical__jacobian_8h.html#ab9edec9fd459b0eb500dbd993b51e0f6" title="Numerically compute the Jacobian matrix of a vector valued function.">calculate_jacobian()</a></code>, this method is fast but not the most accurate, and requires that \( h \) be exactly representable in the computer architecture. With this definition, we ignore any possible implicit time dependence of \( \vec{x} \), which is why we refer to this derivative as the "explicit" time derivative.</p>
<p >One consideration unique to the time derivative is that the time domain is usually finite. If \( t \) is close to the maximum possible value, then this forward perturbation approach is not applicable. In that case, we instead calculate the derivative as</p>
<p class="formulaDsp">
\[
  \frac{d f_i}{dt} \approx \frac{f_i(\vec{x}, t) - f_i(\vec{x}, t - h)}{h}.
\]
</p>
<p >This is a backwards perturbation.</p>
<p >In BioCro, the explicit time derivative is almost always calculated for the case where \( \vec{f}(\vec{x}, t) = d \vec{x} / dt \). In this case, \( \vec{x} \) and \( \vec{y} = \vec{f}(\vec{x}, t) \) have the same dimension. Even in other BioCro applications where \( \vec{f}(\vec{x}, t) \) is not the time derivative of \( \vec{x} \), this restriction on dimensionality still holds. Because of this, here we assume that the output from \( \vec{f} \) <em>always</em> has the same length as \( \vec{x} \).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">equation_ptr</td><td>a pointer to an object that can be used to represent a vector valued function <code>f(x, t)</code>. There must be an associated <code>evaluate_equations(*equation_ptr_type, x, t, y)</code> function defined for <code>equation_ptr_type</code>. It is assumed that the output vector produced by the equations has the same length as the input vector.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">max_time</td><td>the largest time value that can be passed to <code>f</code>.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>an input vector to be passed to <code>f</code>.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>an input time to be passed to <code>f</code>.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f_current</td><td>the output of <code>f</code> evaluated at <code>x</code> and <code>t</code>.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dfdt</td><td>the calculated time derivative, i.e., the vector of derivatives \( df_i / dt \) evaluated at <code>x</code> and <code>t</code>. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="numerical__jacobian_8h_source.html#l00264">264</a> of file <a class="el" href="numerical__jacobian_8h_source.html">numerical_jacobian.h</a>.</p>

<p class="reference">References <a class="el" href="constants_8h_source.html#l00021">calculation_constants::eps_deriv</a>, and <a class="el" href="dynamical__system_8h_source.html#l00470">evaluate_equations()</a>.</p>

<p class="reference">Referenced by <a class="el" href="numerical__jacobian_8h_source.html#l00365">calculate_jacobian_and_time_derivative()</a>, and <a class="el" href="numerical__jacobian_8h_source.html#l00322">calculate_time_derivative()</a>.</p>
<div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><img src="numerical__jacobian_8h_a18e7949927b0bfc86140b3534e790e8c_cgraph.png" border="0" usemap="#anumerical__jacobian_8h_a18e7949927b0bfc86140b3534e790e8c_cgraph" alt=""/></div>
<map name="anumerical__jacobian_8h_a18e7949927b0bfc86140b3534e790e8c_cgraph" id="anumerical__jacobian_8h_a18e7949927b0bfc86140b3534e790e8c_cgraph">
<area shape="rect" title="Numerically compute the explicit time derivatives of a vector valued function." alt="" coords="5,5,175,32"/>
<area shape="rect" href="dynamical__system_8h.html#a3663e16fd2cb02e7095f93993cf8f463" title="Define evaluation behavior for a set of equations defined by a dynamical_system object...." alt="" coords="223,5,357,32"/>
</map>
</div>
<div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><img src="numerical__jacobian_8h_a18e7949927b0bfc86140b3534e790e8c_icgraph.png" border="0" usemap="#anumerical__jacobian_8h_a18e7949927b0bfc86140b3534e790e8c_icgraph" alt=""/></div>
<map name="anumerical__jacobian_8h_a18e7949927b0bfc86140b3534e790e8c_icgraph" id="anumerical__jacobian_8h_a18e7949927b0bfc86140b3534e790e8c_icgraph">
<area shape="rect" title="Numerically compute the explicit time derivatives of a vector valued function." alt="" coords="445,42,615,69"/>
<area shape="rect" href="numerical__jacobian_8h.html#aa69a62289bcec362abb76d68df65e6d3" title="Numerically compute the Jacobian matrix and the explicit time derivative of a vector valued function." alt="" coords="240,5,385,47"/>
<area shape="rect" href="numerical__jacobian_8h.html#a926532563be19071bb0594d54846edcb" title="A wrapper for the six&#45;argument version of calculate_time_derivative() that automatically calculates f..." alt="" coords="228,71,397,98"/>
<area shape="rect" href="classdynamical__system__pointer__wrapper.html#a3e467d4b57d62daa470ec61486a02152" title=" " alt="" coords="5,5,180,47"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Oct 31 2023 16:33:54 for The BioCro C++ Library by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
